<!DOCTYPE html><html lang="zh"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=0.5"><link rel="stylesheet" href="/css/post.css"><link rel="icon" href="/img/favicon.png"><title>设计模式</title><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body>　　<div class="inner"><h2>设计模式</h2><h2 id="1-观察者模式"><a href="#1-观察者模式" class="headerlink" title="1. 观察者模式"></a>1. 观察者模式</h2><ul>
<li>定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，<code>所有依赖的对象都得到通知并自动更新</code>。</li>
<li>将功能分割后，不用再维护各组件间的统一性，使用此模式动态更新。</li>
<li>适用于一个对象改变后需要通知其他对象的场景。</li>
<li>案例，模仿热水器的工作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> abstractmethod, ABCMeta<br><br><br><span class="hljs-comment"># 监听模式 ，热水器是被监听 ， 热水模式为监听 ,温度为监听属性</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WaterHeater</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__observers = []<br>        self.__temperature = <span class="hljs-number">0</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【初始化】热水器开始工作啦~~~&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_temperature</span>(<span class="hljs-params">self, t</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt; t &lt;= <span class="hljs-number">200</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【设置温度】将温度设置为：&quot;</span>, t)<br>            self.__temperature = t<br>            self.update()<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_temperature</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__temperature<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_observers</span>(<span class="hljs-params">self, observer</span>):</span><br>        self.__observers.append(observer)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.__observers) &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> self.__observers:<br>                <span class="hljs-comment"># 把自己传递过去</span><br>                o.update(self)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Observer</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WashingMode</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span><br>        <span class="hljs-keyword">if</span> waterHeater.get_temperature() &gt; <span class="hljs-number">70</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【洗澡模式】 开始洗白白~ &quot;</span>)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DrinkingMode</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span><br>        <span class="hljs-keyword">if</span> waterHeater.get_temperature() &gt;= <span class="hljs-number">100</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【饮用模式】 水可以喝了~ &quot;</span>)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PlayingMode</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-number">30</span> &lt; waterHeater.get_temperature() &lt; <span class="hljs-number">50</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【快乐模式】 尽情嗨皮吧~ &quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    myWaterHeater = WaterHeater()<br>    myWaterHeater.add_observers(WashingMode())<br>    myWaterHeater.add_observers(DrinkingMode())<br>    myWaterHeater.add_observers(PlayingMode())<br><br>    myWaterHeater.set_temperature(<span class="hljs-number">10</span>)<br>    myWaterHeater.set_temperature(<span class="hljs-number">40</span>)<br>    myWaterHeater.set_temperature(<span class="hljs-number">70</span>)<br>    myWaterHeater.set_temperature(<span class="hljs-number">90</span>)<br>    myWaterHeater.set_temperature(<span class="hljs-number">110</span>)<br><br><span class="hljs-comment"># output</span><br>【初始化】热水器开始工作啦~~~<br>【设置温度】将温度设置为： <span class="hljs-number">10</span><br>【设置温度】将温度设置为： <span class="hljs-number">40</span><br>【快乐模式】 尽情嗨皮吧~ <br>【设置温度】将温度设置为： <span class="hljs-number">70</span><br>【设置温度】将温度设置为： <span class="hljs-number">90</span><br>【洗澡模式】 开始洗白白~ <br>【设置温度】将温度设置为： <span class="hljs-number"><code class="language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> abstractmethod, ABCMeta<br><br><br><span class="hljs-comment"># 监听模式 ，热水器是被监听 ， 热水模式为监听 ,温度为监听属性</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WaterHeater</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__observers = []<br>        self.__temperature = <span class="hljs-number">0</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【初始化】热水器开始工作啦~~~&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_temperature</span>(<span class="hljs-params">self, t</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt; t &lt;= <span class="hljs-number">200</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【设置温度】将温度设置为：&quot;</span>, t)<br>            self.__temperature = t<br>            self.update()<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_temperature</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__temperature<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_observers</span>(<span class="hljs-params">self, observer</span>):</span><br>        self.__observers.append(observer)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.__observers) &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> self.__observers:<br>                <span class="hljs-comment"># 把自己传递过去</span><br>                o.update(self)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Observer</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WashingMode</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span><br>        <span class="hljs-keyword">if</span> waterHeater.get_temperature() &gt; <span class="hljs-number">70</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【洗澡模式】 开始洗白白~ &quot;</span>)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DrinkingMode</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span><br>        <span class="hljs-keyword">if</span> waterHeater.get_temperature() &gt;= <span class="hljs-number">100</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【饮用模式】 水可以喝了~ &quot;</span>)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PlayingMode</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, waterHeater</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-number">30</span> &lt; waterHeater.get_temperature() &lt; <span class="hljs-number">50</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【快乐模式】 尽情嗨皮吧~ &quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    myWaterHeater = WaterHeater()<br>    myWaterHeater.add_observers(WashingMode())<br>    myWaterHeater.add_observers(DrinkingMode())<br>    myWaterHeater.add_observers(PlayingMode())<br><br>    myWaterHeater.set_temperature(<span class="hljs-number">10</span>)<br>    myWaterHeater.set_temperature(<span class="hljs-number">40</span>)<br>    myWaterHeater.set_temperature(<span class="hljs-number">70</span>)<br>    myWaterHeater.set_temperature(<span class="hljs-number">90</span>)<br>    myWaterHeater.set_temperature(<span class="hljs-number">110</span>)<br><br><span class="hljs-comment"># output</span><br>【初始化】热水器开始工作啦~~~<br>【设置温度】将温度设置为： <span class="hljs-number">10</span><br>【设置温度】将温度设置为： <span class="hljs-number">40</span><br>【快乐模式】 尽情嗨皮吧~ <br>【设置温度】将温度设置为： <span class="hljs-number">70</span><br>【设置温度】将温度设置为： <span class="hljs-number">90</span><br>【洗澡模式】 开始洗白白~ <br>【设置温度】将温度设置为： <span class="hljs-number">110</span><br>【洗澡模式】 开始洗白白~ <br>【饮用模式】 水可以喝了~ <br></code></pre></td></tr></table></figure>

<ul>
<li>主要代码  ，设置被监听的属性，如果改变则更新同步到所有的监听</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_temperature</span>(<span class="hljs-params">self, t</span>):</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt; t &lt;= <span class="hljs-number">200</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【设置温度】将温度设置为：&quot;</span>, t)<br>        self.__temperature = t<br>        self.update()<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self</span>):</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.__observers) &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> self.__observers:<br>            <span class="hljs-comment"><code class="language-hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_temperature</span>(<span class="hljs-params">self, t</span>):</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt; t &lt;= <span class="hljs-number">200</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;【设置温度】将温度设置为：&quot;</span>, t)<br>        self.__temperature = t<br>        self.update()<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self</span>):</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.__observers) &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> self.__observers:<br>            <span class="hljs-comment"># 把自己传递过去</span><br>            o.update(self)<br></code></pre></td></tr></table></figure>



<ul>
<li><code>监听者模式的要点是搞清楚 谁是监听者，谁是被监听的对象， 被监听对象的属性是什么，一旦被监听者的属性发生改变则立即通知监听者（使用统一的接口update）</code></li>
<li>监听者模式的框架：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Observable</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__observers = []<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_observer</span>(<span class="hljs-params">self, observer</span>):</span><br>        self.__observers.append(observer)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_observer</span>(<span class="hljs-params">self, observer</span>):</span><br>        self.__observers.remove(observer)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">notifies</span>(<span class="hljs-params">self, <span class="hljs-built_in">object</span>=<span class="hljs-number">0</span></span>):</span><br>        <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> self.__observers:<br>            o.update(self, <span class="hljs-built_in">object</span>)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Observer</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, observable, <span class="hljs-built_in">object</span></span>):</span><br>        <span class="hljs-keyword"><code class="language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Observable</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__observers = []<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_observer</span>(<span class="hljs-params">self, observer</span>):</span><br>        self.__observers.append(observer)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_observer</span>(<span class="hljs-params">self, observer</span>):</span><br>        self.__observers.remove(observer)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">notifies</span>(<span class="hljs-params">self, <span class="hljs-built_in">object</span>=<span class="hljs-number">0</span></span>):</span><br>        <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> self.__observers:<br>            o.update(self, <span class="hljs-built_in">object</span>)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Observer</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, observable, <span class="hljs-built_in">object</span></span>):</span><br>        <span class="hljs-keyword">pass</span><br><br></code></pre></td></tr></table></figure>

<ul>
<li>案例，用监听者模式做异地登录检测。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment"># 判断用户是否异常登录，如果正常登录则发送短信、邮件通知</span><br><span class="hljs-comment"># 用户为被观察者，被观察的属性为登录状态（是否异地登录），观察者（短信、邮件）</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span>(<span class="hljs-params">Observable</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.__last_login_ip = <span class="hljs-string">&#x27;&#x27;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_lastip</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__last_login_ip<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>(<span class="hljs-params">self, ip, user</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[登录成功] 您的登录IP为: &#123;&#125; ,用户名为: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(ip, user))<br>        <span class="hljs-keyword">if</span> self.is_lastip(ip):<br>            self.notifies(self)<br>        self.__last_login_ip = ip<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_lastip</span>(<span class="hljs-params">self, ip</span>):</span><br>        <span class="hljs-keyword">if</span> self.__last_login_ip != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> self.__last_login_ip != ip:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SMS</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, observable, <span class="hljs-built_in">object</span></span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[短信通知] 您的账户异地登录，上次登录的IP为： &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">object</span>.get_lastip()))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Email</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, observable, <span class="hljs-built_in">object</span></span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[邮件通知] 您的账户异常登录，上次登录的IP为： &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">object</span>.get_lastip()))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    account = Account()<br>    account.add_observer(SMS())<br>    account.add_observer(Email())<br>    account.login(<span class="hljs-string">&#x27;1.1.1.1&#x27;</span>, <span class="hljs-string">&#x27;tom&#x27;</span>)<br>    account.login(<span class="hljs-string">&#x27;2.2.2.2&#x27;</span>, <span class="hljs-string">&#x27;tom&#x27;</span>)<br>    account.login(<span class="hljs-string">&#x27;2.2.2.2&#x27;</span>, <span class="hljs-string">&#x27;tom&#x27;</span>)<br><br>    <br><span class="hljs-comment"># output </span><br>[登录成功] 您的登录IP为: <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span> ,用户名为: tom<br>[登录成功] 您的登录IP为: <span class="hljs-number">2.2</span><span class="hljs-number">.2</span><span class="hljs-number">.2</span> ,用户名为: tom<br>[短信通知] 您的账户异地登录，上次登录的IP为： <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><br>[邮件通知] 您的账户异常登录，上次登录的IP为： <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><br>[登录成功] 您的登录IP为: <span class="hljs-number">2.2</span><span class="hljs-number">.2</span><span class="hljs-number"><code class="language-hljs python"><span class="hljs-comment"># 判断用户是否异常登录，如果正常登录则发送短信、邮件通知</span><br><span class="hljs-comment"># 用户为被观察者，被观察的属性为登录状态（是否异地登录），观察者（短信、邮件）</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span>(<span class="hljs-params">Observable</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.__last_login_ip = <span class="hljs-string">&#x27;&#x27;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_lastip</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__last_login_ip<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>(<span class="hljs-params">self, ip, user</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[登录成功] 您的登录IP为: &#123;&#125; ,用户名为: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(ip, user))<br>        <span class="hljs-keyword">if</span> self.is_lastip(ip):<br>            self.notifies(self)<br>        self.__last_login_ip = ip<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_lastip</span>(<span class="hljs-params">self, ip</span>):</span><br>        <span class="hljs-keyword">if</span> self.__last_login_ip != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> self.__last_login_ip != ip:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SMS</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, observable, <span class="hljs-built_in">object</span></span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[短信通知] 您的账户异地登录，上次登录的IP为： &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">object</span>.get_lastip()))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Email</span>(<span class="hljs-params">Observer</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, observable, <span class="hljs-built_in">object</span></span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[邮件通知] 您的账户异常登录，上次登录的IP为： &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">object</span>.get_lastip()))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    account = Account()<br>    account.add_observer(SMS())<br>    account.add_observer(Email())<br>    account.login(<span class="hljs-string">&#x27;1.1.1.1&#x27;</span>, <span class="hljs-string">&#x27;tom&#x27;</span>)<br>    account.login(<span class="hljs-string">&#x27;2.2.2.2&#x27;</span>, <span class="hljs-string">&#x27;tom&#x27;</span>)<br>    account.login(<span class="hljs-string">&#x27;2.2.2.2&#x27;</span>, <span class="hljs-string">&#x27;tom&#x27;</span>)<br><br>    <br><span class="hljs-comment"># output </span><br>[登录成功] 您的登录IP为: <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span> ,用户名为: tom<br>[登录成功] 您的登录IP为: <span class="hljs-number">2.2</span><span class="hljs-number">.2</span><span class="hljs-number">.2</span> ,用户名为: tom<br>[短信通知] 您的账户异地登录，上次登录的IP为： <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><br>[邮件通知] 您的账户异常登录，上次登录的IP为： <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><br>[登录成功] 您的登录IP为: <span class="hljs-number">2.2</span><span class="hljs-number">.2</span><span class="hljs-number">.2</span> ,用户名为: tom<br><br></code></pre></td></tr></table></figure>



<h2 id="2-状态模式"><a href="#2-状态模式" class="headerlink" title="2. 状态模式"></a>2. 状态模式</h2><ul>
<li><p>状态模式让类可以无缝切换状态，各状态有统一的接口不同的行为。</p>
</li>
<li><p>示例，模仿水在固态、气态、液态切换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Water</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__temperatrue = <span class="hljs-number">0</span><br>        self.__state = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_state</span>(<span class="hljs-params">self, state</span>):</span><br>        <span class="hljs-keyword">if</span> self.state <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;初始化状态为：&quot;</span>, state.get_name())<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;状态由&quot;</span>, self.__state.get_name(), <span class="hljs-string">&quot;变更为：&quot;</span>, state.get_name())<br><br>        self.__state = state<br>	<br>    <span class="hljs-comment"># 属性改变时切换状态</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_temperature</span>(<span class="hljs-params">self, temperature</span>):</span><br>        <span class="hljs-keyword">if</span> temperature &lt;= <span class="hljs-number">0</span>:<br>            self.change_state(SolidState())<br>        <span class="hljs-keyword">elif</span> temperature &lt;= <span class="hljs-number">100</span>:<br>            self.change_state(LiquidState())<br>        <span class="hljs-keyword">else</span>:<br>            self.change_state(GaseousState())<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_temperatrue</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__temperatrue<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self</span>):</span><br>        self.__state.behavior(self)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.name = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, water</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SolidState</span>(<span class="hljs-params">State</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.name = <span class="hljs-string">&quot;固态&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, water</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是固态，当前温度为：&quot;</span>, water.get_temperatrue())<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LiquidState</span>(<span class="hljs-params">State</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.name = <span class="hljs-string">&quot;液态&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, water</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是液态，当前温度为：&quot;</span>, water.get_temperatrue())<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GaseousState</span>(<span class="hljs-params">State</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.name = <span class="hljs-string">&quot;气态&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, water</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Water</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__temperatrue = <span class="hljs-number">0</span><br>        self.__state = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_state</span>(<span class="hljs-params">self, state</span>):</span><br>        <span class="hljs-keyword">if</span> self.state <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;初始化状态为：&quot;</span>, state.get_name())<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;状态由&quot;</span>, self.__state.get_name(), <span class="hljs-string">&quot;变更为：&quot;</span>, state.get_name())<br><br>        self.__state = state<br>	<br>    <span class="hljs-comment"># 属性改变时切换状态</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_temperature</span>(<span class="hljs-params">self, temperature</span>):</span><br>        <span class="hljs-keyword">if</span> temperature &lt;= <span class="hljs-number">0</span>:<br>            self.change_state(SolidState())<br>        <span class="hljs-keyword">elif</span> temperature &lt;= <span class="hljs-number">100</span>:<br>            self.change_state(LiquidState())<br>        <span class="hljs-keyword">else</span>:<br>            self.change_state(GaseousState())<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_temperatrue</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__temperatrue<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self</span>):</span><br>        self.__state.behavior(self)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.name = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, water</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SolidState</span>(<span class="hljs-params">State</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.name = <span class="hljs-string">&quot;固态&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, water</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是固态，当前温度为：&quot;</span>, water.get_temperatrue())<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LiquidState</span>(<span class="hljs-params">State</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.name = <span class="hljs-string">&quot;液态&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, water</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是液态，当前温度为：&quot;</span>, water.get_temperatrue())<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GaseousState</span>(<span class="hljs-params">State</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.name = <span class="hljs-string">&quot;气态&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, water</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"我是液态，当前温度为："</span>, water.get_temperatrue())<br><br></code></pre></td></tr></table></figure></li>
<li><p>主要代码，提供一个状态接口，有统一的行为，当属性更变时即可无缝切换。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Water</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__temperatrue = <span class="hljs-number">0</span><br>        self.__state = <span class="hljs-literal">None</span><br>        <br>    <span class="hljs-comment"># 属性改变时切换状态</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_temperature</span>(<span class="hljs-params">self, temperature</span>):</span><br>        <span class="hljs-keyword">if</span> temperature &lt;= <span class="hljs-number">0</span>:<br>            self.change_state(SolidState())<br>        <span class="hljs-keyword">elif</span> temperature &lt;= <span class="hljs-number">100</span>:<br>            self.change_state(LiquidState())<br>        <span class="hljs-keyword">else</span>:<br>            self.change_state(GaseousState())<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Water</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__temperatrue = <span class="hljs-number">0</span><br>        self.__state = <span class="hljs-literal">None</span><br>        <br>    <span class="hljs-comment"># 属性改变时切换状态</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_temperature</span>(<span class="hljs-params">self, temperature</span>):</span><br>        <span class="hljs-keyword">if</span> temperature &lt;= <span class="hljs-number">0</span>:<br>            self.change_state(SolidState())<br>        <span class="hljs-keyword">elif</span> temperature &lt;= <span class="hljs-number">100</span>:<br>            self.change_state(LiquidState())<br>        <span class="hljs-keyword">else</span>:<br>            self.change_state(GaseousState())<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self</span>):</span><br>        self.__state.behavior(self)<br></code></pre></td></tr></table></figure></li>
<li><p>基于框架的代码实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Context</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__states = []<br>        self.__state_info = <span class="hljs-literal">None</span><br>        self.__current_state = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_state</span>(<span class="hljs-params">self, state</span>):</span><br>        <span class="hljs-keyword">if</span> state <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.__states:<br>            self.__states.append(state)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_state</span>(<span class="hljs-params">self, state</span>):</span><br>        self.__current_state = state<br>        self.add_state(state)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_state_info</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">for</span> state <span class="hljs-keyword">in</span> self.__states:<br>            <span class="hljs-comment"># 降低耦合，把判断条件交给子类区判断</span><br>            <span class="hljs-keyword">if</span> state.is_match(self.__state_info):<br>                self.change_state(state)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self</span>):</span><br>        self.__current_state.behavior(self)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_match</span>(<span class="hljs-params">self, state_info</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, context</span>):</span><br>        <span class="hljs-keyword"><code class="language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Context</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__states = []<br>        self.__state_info = <span class="hljs-literal">None</span><br>        self.__current_state = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_state</span>(<span class="hljs-params">self, state</span>):</span><br>        <span class="hljs-keyword">if</span> state <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.__states:<br>            self.__states.append(state)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_state</span>(<span class="hljs-params">self, state</span>):</span><br>        self.__current_state = state<br>        self.add_state(state)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_state_info</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">for</span> state <span class="hljs-keyword">in</span> self.__states:<br>            <span class="hljs-comment"># 降低耦合，把判断条件交给子类区判断</span><br>            <span class="hljs-keyword">if</span> state.is_match(self.__state_info):<br>                self.change_state(state)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self</span>):</span><br>        self.__current_state.behavior(self)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_match</span>(<span class="hljs-params">self, state_info</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">behavior</span>(<span class="hljs-params">self, context</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-中介模式"><a href="#3-中介模式" class="headerlink" title="3. 中介模式"></a>3. 中介模式</h2><ul>
<li><p>中介模式，适用1对多的情况，将中间复杂的关系交给中介处理，个体1只需要处理与中介的逻辑即可。</p>
</li>
<li><p>中介找房案例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HouseInfo</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, area, price, has_window, has_bathroom, has_kitchen, address, owner</span>):</span><br>        self.__area = area<br>        self.__price = price<br>        self.__has_window = has_window<br>        self.__has_bathroom = has_bathroom<br>        self.__has_kitchen = has_kitchen<br>        self.__address = address<br>        self.__owner = owner<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_address</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__address<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_onwer_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__owner.get_name()<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show_info</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;面积： &quot;</span> + <span class="hljs-built_in">str</span>(self.__area) + <span class="hljs-string">&quot;平方米&quot;</span> +<br>              <span class="hljs-string">&quot;价格： &quot;</span> + <span class="hljs-built_in">str</span>(self.__price) + <span class="hljs-string">&quot;元&quot;</span> +<br>              <span class="hljs-string">&quot;窗户： &quot;</span> + (<span class="hljs-string">&quot;有&quot;</span> <span class="hljs-keyword">if</span> self.__has_window <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;没有&quot;</span>) +<br>              <span class="hljs-string">&quot;厨房： &quot;</span> + (<span class="hljs-string">&quot;有&quot;</span> <span class="hljs-keyword">if</span> self.__has_kitchen <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;没有&quot;</span>) +<br>              <span class="hljs-string">&quot;浴室： &quot;</span> + (<span class="hljs-string">&quot;有&quot;</span> <span class="hljs-keyword">if</span> self.__has_bathroom <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;没有&quot;</span>))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HousingAgency</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__house_infos = []<br>        self.__name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_houseinfo</span>(<span class="hljs-params">self, houseinfo</span>):</span><br>        <span class="hljs-keyword">if</span> houseinfo <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.__house_infos:<br>            self.__house_infos.append(houseinfo)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_houseinfo</span>(<span class="hljs-params">self, houseinfo</span>):</span><br>        <span class="hljs-keyword">for</span> info <span class="hljs-keyword">in</span> self.__house_infos:<br>            <span class="hljs-keyword">if</span> info == houseinfo:<br>                self.__house_infos.remove(info)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_search_condition</span>(<span class="hljs-params">self, description</span>):</span><br>        <span class="hljs-keyword">return</span> description<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_match_infos</span>(<span class="hljs-params">self, search_condition</span>):</span><br>        <span class="hljs-built_in">print</span>(self.get_name(), <span class="hljs-string">&quot;为您找到一下最合适的房源：&quot;</span>)<br>        <span class="hljs-keyword">for</span> info <span class="hljs-keyword">in</span> self.__house_infos:<br>            info.show_info()<br>        <span class="hljs-keyword">return</span> self.__house_infos<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_contract</span>(<span class="hljs-params">self, houseinfo, period</span>):</span><br>        <span class="hljs-built_in">print</span>(self.get_name(), <span class="hljs-string">&quot;与房东&quot;</span>, houseinfo.get_onwer_name(), <span class="hljs-string">&quot;签订&quot;</span>, houseinfo.get_address(), <span class="hljs-string">&quot;的房子合同，租期为：&quot;</span>, period, <span class="hljs-string">&quot;年, 租期内&quot;</span>, self.get_name(), <span class="hljs-string">&quot;有权对其进行使用和转租！&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_contracts</span>(<span class="hljs-params">self, period</span>):</span><br>        <span class="hljs-keyword">for</span> info <span class="hljs-keyword">in</span> self.__house_infos:<br>            self.sign_contract(info, period)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HouseOwner</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__houseinfo = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_houseinfo</span>(<span class="hljs-params">self,  area, price, has_window, has_bathroom, has_kitchen, address, owner</span>):</span><br>        self.__houseinfo = HouseInfo(area, price, has_window, has_bathroom, has_kitchen, address, owner)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">public_houseinfo</span>(<span class="hljs-params">self, agency</span>):</span><br>        agency.add_houseinfo(self.__houseinfo)<br>        <span class="hljs-built_in">print</span>(self.get_name(), <span class="hljs-string">&quot;在&quot;</span>, agency.get_name(), <span class="hljs-string">&quot;发布房源出租信息&quot;</span>)<br>        self.__houseinfo.show_info()<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_house</span>(<span class="hljs-params">self, description, agency</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是&quot;</span> + self.get_name() + <span class="hljs-string">&quot;，我想找一个&quot;</span>, description , <span class="hljs-string">&quot;的房子&quot;</span>)<br>        <span class="hljs-built_in">print</span>()<br>        <span class="hljs-keyword">return</span> agency.get_match_infos(agency.get_search_condition(description))<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">see_house</span>(<span class="hljs-params">self, houseinfos</span>):</span><br>        size = <span class="hljs-built_in">len</span>(houseinfos)<br>        <span class="hljs-keyword">return</span> houseinfos[size-<span class="hljs-number">1</span>]<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_contract</span>(<span class="hljs-params">self, houseinfo, agency, period</span>):</span><br>        <span class="hljs-built_in">print</span>(self.get_name(), <span class="hljs-string">&quot;与中介&quot;</span>, agency.get_name(), <span class="hljs-string">&quot;签订&quot;</span>, houseinfo.get_address(), <span class="hljs-string">&quot;的房子的组人合同，租期&quot;</span>, period, <span class="hljs-string">&quot;年，合同期内&quot;</span>, self.__name , <span class="hljs-string">&quot;有权使用！&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    myhome = HousingAgency(<span class="hljs-string">&quot;我爱你家&quot;</span>)<br>    zhangsan = HouseOwner(<span class="hljs-string">&quot;张三&quot;</span>)<br>    zhangsan.set_houseinfo(<span class="hljs-number">20</span>, <span class="hljs-number">2600</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-string">&quot;上地犀利&quot;</span>, zhangsan)<br>    zhangsan.public_houseinfo(myhome)<br><br>    lisi = HouseOwner(<span class="hljs-string">&quot;李四&quot;</span>)<br>    lisi.set_houseinfo(<span class="hljs-number">30</span>, <span class="hljs-number">3800</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-string">&quot;西二旗的太阳&quot;</span>, lisi)<br>    lisi.public_houseinfo(myhome)<br><br>    wangwu = HouseOwner(<span class="hljs-string">&quot;王五&quot;</span>)<br>    wangwu.set_houseinfo(<span class="hljs-number">40</span>, <span class="hljs-number">5200</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-string">&quot;东直门的艾利欧&quot;</span>, wangwu)<br>    wangwu.public_houseinfo(myhome)<br>    <span class="hljs-built_in">print</span>()<br><br>    myhome.sign_contracts(<span class="hljs-number">3</span>)<br>    <span class="hljs-built_in">print</span>()<br><br>    tony = Customer(<span class="hljs-string">&quot;Tony&quot;</span>)<br>    houseinfos = tony.find_house(<span class="hljs-string">&quot;18平方米，要有独立卫生间，要有窗户，最好朝南，有厨房更好！价位200左右&quot;</span>, myhome)<br>    <span class="hljs-built_in">print</span>()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;正在看房，寻找最合适的房子&quot;</span>)<br>    <span class="hljs-built_in">print</span>()<br><br>    appropriate_house = tony.see_house(houseinfos)<br>    <span class="hljs-built_in">print</span>()<br>    tony.sign_contract(appropriate_house, myhome, <span class="hljs-number"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HouseInfo</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, area, price, has_window, has_bathroom, has_kitchen, address, owner</span>):</span><br>        self.__area = area<br>        self.__price = price<br>        self.__has_window = has_window<br>        self.__has_bathroom = has_bathroom<br>        self.__has_kitchen = has_kitchen<br>        self.__address = address<br>        self.__owner = owner<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_address</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__address<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_onwer_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__owner.get_name()<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show_info</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;面积： &quot;</span> + <span class="hljs-built_in">str</span>(self.__area) + <span class="hljs-string">&quot;平方米&quot;</span> +<br>              <span class="hljs-string">&quot;价格： &quot;</span> + <span class="hljs-built_in">str</span>(self.__price) + <span class="hljs-string">&quot;元&quot;</span> +<br>              <span class="hljs-string">&quot;窗户： &quot;</span> + (<span class="hljs-string">&quot;有&quot;</span> <span class="hljs-keyword">if</span> self.__has_window <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;没有&quot;</span>) +<br>              <span class="hljs-string">&quot;厨房： &quot;</span> + (<span class="hljs-string">&quot;有&quot;</span> <span class="hljs-keyword">if</span> self.__has_kitchen <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;没有&quot;</span>) +<br>              <span class="hljs-string">&quot;浴室： &quot;</span> + (<span class="hljs-string">&quot;有&quot;</span> <span class="hljs-keyword">if</span> self.__has_bathroom <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;没有&quot;</span>))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HousingAgency</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__house_infos = []<br>        self.__name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_houseinfo</span>(<span class="hljs-params">self, houseinfo</span>):</span><br>        <span class="hljs-keyword">if</span> houseinfo <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.__house_infos:<br>            self.__house_infos.append(houseinfo)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_houseinfo</span>(<span class="hljs-params">self, houseinfo</span>):</span><br>        <span class="hljs-keyword">for</span> info <span class="hljs-keyword">in</span> self.__house_infos:<br>            <span class="hljs-keyword">if</span> info == houseinfo:<br>                self.__house_infos.remove(info)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_search_condition</span>(<span class="hljs-params">self, description</span>):</span><br>        <span class="hljs-keyword">return</span> description<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_match_infos</span>(<span class="hljs-params">self, search_condition</span>):</span><br>        <span class="hljs-built_in">print</span>(self.get_name(), <span class="hljs-string">&quot;为您找到一下最合适的房源：&quot;</span>)<br>        <span class="hljs-keyword">for</span> info <span class="hljs-keyword">in</span> self.__house_infos:<br>            info.show_info()<br>        <span class="hljs-keyword">return</span> self.__house_infos<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_contract</span>(<span class="hljs-params">self, houseinfo, period</span>):</span><br>        <span class="hljs-built_in">print</span>(self.get_name(), <span class="hljs-string">&quot;与房东&quot;</span>, houseinfo.get_onwer_name(), <span class="hljs-string">&quot;签订&quot;</span>, houseinfo.get_address(), <span class="hljs-string">&quot;的房子合同，租期为：&quot;</span>, period, <span class="hljs-string">&quot;年, 租期内&quot;</span>, self.get_name(), <span class="hljs-string">&quot;有权对其进行使用和转租！&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_contracts</span>(<span class="hljs-params">self, period</span>):</span><br>        <span class="hljs-keyword">for</span> info <span class="hljs-keyword">in</span> self.__house_infos:<br>            self.sign_contract(info, period)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HouseOwner</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__houseinfo = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_houseinfo</span>(<span class="hljs-params">self,  area, price, has_window, has_bathroom, has_kitchen, address, owner</span>):</span><br>        self.__houseinfo = HouseInfo(area, price, has_window, has_bathroom, has_kitchen, address, owner)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">public_houseinfo</span>(<span class="hljs-params">self, agency</span>):</span><br>        agency.add_houseinfo(self.__houseinfo)<br>        <span class="hljs-built_in">print</span>(self.get_name(), <span class="hljs-string">&quot;在&quot;</span>, agency.get_name(), <span class="hljs-string">&quot;发布房源出租信息&quot;</span>)<br>        self.__houseinfo.show_info()<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_house</span>(<span class="hljs-params">self, description, agency</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是&quot;</span> + self.get_name() + <span class="hljs-string">&quot;，我想找一个&quot;</span>, description , <span class="hljs-string">&quot;的房子&quot;</span>)<br>        <span class="hljs-built_in">print</span>()<br>        <span class="hljs-keyword">return</span> agency.get_match_infos(agency.get_search_condition(description))<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">see_house</span>(<span class="hljs-params">self, houseinfos</span>):</span><br>        size = <span class="hljs-built_in">len</span>(houseinfos)<br>        <span class="hljs-keyword">return</span> houseinfos[size-<span class="hljs-number">1</span>]<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign_contract</span>(<span class="hljs-params">self, houseinfo, agency, period</span>):</span><br>        <span class="hljs-built_in">print</span>(self.get_name(), <span class="hljs-string">&quot;与中介&quot;</span>, agency.get_name(), <span class="hljs-string">&quot;签订&quot;</span>, houseinfo.get_address(), <span class="hljs-string">&quot;的房子的组人合同，租期&quot;</span>, period, <span class="hljs-string">&quot;年，合同期内&quot;</span>, self.__name , <span class="hljs-string">&quot;有权使用！&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    myhome = HousingAgency(<span class="hljs-string">&quot;我爱你家&quot;</span>)<br>    zhangsan = HouseOwner(<span class="hljs-string">&quot;张三&quot;</span>)<br>    zhangsan.set_houseinfo(<span class="hljs-number">20</span>, <span class="hljs-number">2600</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-string">&quot;上地犀利&quot;</span>, zhangsan)<br>    zhangsan.public_houseinfo(myhome)<br><br>    lisi = HouseOwner(<span class="hljs-string">&quot;李四&quot;</span>)<br>    lisi.set_houseinfo(<span class="hljs-number">30</span>, <span class="hljs-number">3800</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-string">&quot;西二旗的太阳&quot;</span>, lisi)<br>    lisi.public_houseinfo(myhome)<br><br>    wangwu = HouseOwner(<span class="hljs-string">&quot;王五&quot;</span>)<br>    wangwu.set_houseinfo(<span class="hljs-number">40</span>, <span class="hljs-number">5200</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-literal">True</span>, <span class="hljs-string">&quot;东直门的艾利欧&quot;</span>, wangwu)<br>    wangwu.public_houseinfo(myhome)<br>    <span class="hljs-built_in">print</span>()<br><br>    myhome.sign_contracts(<span class="hljs-number">3</span>)<br>    <span class="hljs-built_in">print</span>()<br><br>    tony = Customer(<span class="hljs-string">&quot;Tony&quot;</span>)<br>    houseinfos = tony.find_house(<span class="hljs-string">&quot;18平方米，要有独立卫生间，要有窗户，最好朝南，有厨房更好！价位200左右&quot;</span>, myhome)<br>    <span class="hljs-built_in">print</span>()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;正在看房，寻找最合适的房子&quot;</span>)<br>    <span class="hljs-built_in">print</span>()<br><br>    appropriate_house = tony.see_house(houseinfos)<br>    <span class="hljs-built_in">print</span>()<br>    tony.sign_contract(appropriate_house, myhome, <span class="hljs-number">1</span>)<br><br><br></code></pre></td></tr></table></figure></li>
<li><p>主要代码，没有主要代码，上述案例只是一种体现中介模式的方式，中介将个人与房东联合的操作聚合在一个类中，方便了个人与房东，但是复杂了中介类。</p>
</li>
<li><p>设备驱动案例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> Enum<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceType</span>(<span class="hljs-params">Enum</span>):</span><br>    TypeSpeaker = <span class="hljs-number">1</span><br>    TypeMicrophone = <span class="hljs-number">2</span><br>    TypeCamera = <span class="hljs-number">3</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceItem</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, <span class="hljs-built_in">id</span>, name, <span class="hljs-built_in">type</span>, isDefault=<span class="hljs-literal">False</span></span>):</span><br>        self.__<span class="hljs-built_in">id</span> = <span class="hljs-built_in">id</span><br>        self.__name = name<br>        self.__<span class="hljs-built_in">type</span> = <span class="hljs-built_in">type</span><br>        self.__isDefault = isDefault<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;type: &quot;</span> + <span class="hljs-built_in">str</span>(self.__<span class="hljs-built_in">type</span>) + <span class="hljs-string">&quot;id: &quot;</span> + <span class="hljs-built_in">str</span>(self.__<span class="hljs-built_in">id</span>) + <span class="hljs-string">&quot;name: &quot;</span> + <span class="hljs-built_in">str</span>(<br>            self.__name) + <span class="hljs-string">&quot;isDefault: &quot;</span> + <span class="hljs-built_in">str</span>(self.__isDefault)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getId</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__<span class="hljs-built_in">id</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getNmae</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getType</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__<span class="hljs-built_in">type</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isDefault</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__isDefault<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceList</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__devices = []<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add</span>(<span class="hljs-params">self, deviceItem</span>):</span><br>        self.__devices.append(deviceItem)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getCount</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.__devices)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getByIdx</span>(<span class="hljs-params">self, idx</span>):</span><br>        <span class="hljs-keyword">if</span> idx &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> idx &gt;= self.getCount():<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">return</span> self.__devices[idx]<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getById</span>(<span class="hljs-params">self, <span class="hljs-built_in">id</span></span>):</span><br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> self.__devices:<br>            <span class="hljs-keyword">if</span> item.getId() == <span class="hljs-built_in">id</span>:<br>                <span class="hljs-keyword">return</span> item<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceMgr</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">enumerate</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">active</span>(<span class="hljs-params">self, deviceId</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getCurDeviceId</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpeakerMgr</span>(<span class="hljs-params">DeviceMgr</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__curDeviceId = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">enumerate</span>(<span class="hljs-params">self</span>):</span><br>        devices = DeviceList()<br>        devices.add(<br>            DeviceItem(<span class="hljs-string">&quot;37dd1024-843b-83a1-934c-81ac9230111&quot;</span>, <span class="hljs-string">&quot;Realtek HighDefinition Audio&quot;</span>, DeviceType.TypeSpeaker,<br>                       <span class="hljs-literal">True</span>))<br>        devices.add(<br>            DeviceItem(<span class="hljs-string">&quot;215a41c60-1313-24aa-1241-324ac3f445&quot;</span>, <span class="hljs-string">&quot;NVIDIA HighDefinition Audio&quot;</span>, DeviceType.TypeSpeaker,<br>                       <span class="hljs-literal">True</span>))<br>        <span class="hljs-keyword">return</span> devices<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">active</span>(<span class="hljs-params">self, deviceId</span>):</span><br>        self.__curDeviceId = deviceId<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getCurDeviceId</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__curDeviceId<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceUtil</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__mgrs = &#123;DeviceType.TypeSpeaker: SpeakerMgr()&#125;<br>        <span class="hljs-comment"># self.__microphoneMgr =</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__getDeviceMgr</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span></span>):</span><br>        <span class="hljs-keyword">return</span> self.__mgrs[<span class="hljs-built_in">type</span>]<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getDeviceList</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span></span>):</span><br>        <span class="hljs-keyword">return</span> self.__getDeviceMgr(<span class="hljs-built_in">type</span>).<span class="hljs-built_in">enumerate</span>()<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">active</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span>, deviceId</span>):</span><br>        self.__getDeviceMgr(<span class="hljs-built_in">type</span>).active(deviceId)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getCurDeviceId</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span></span>):</span><br>        <span class="hljs-keyword">return</span> self.__getDeviceMgr(<span class="hljs-built_in">type</span>).getCurDeviceId()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    deviceUtil = DeviceUtil()<br>    deviceList = deviceUtil.getDeviceList(DeviceType.TypeSpeaker)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;麦克风设备列表：&quot;</span>)<br>    <span class="hljs-keyword">if</span> devDeviceItemiceList.getCount() &gt; <span class="hljs-number">0</span>:<br>        deviceUtil.active(DeviceType.TypeSpeaker, deviceList.getByIdx(<span class="hljs-number">0</span>).getId())<br><br>    <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, deviceList.getCount()):<br>        device = deviceList.getByIdx(idx)<br>        <span class="hljs-built_in">print</span>(device)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> Enum<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceType</span>(<span class="hljs-params">Enum</span>):</span><br>    TypeSpeaker = <span class="hljs-number">1</span><br>    TypeMicrophone = <span class="hljs-number">2</span><br>    TypeCamera = <span class="hljs-number">3</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceItem</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, <span class="hljs-built_in">id</span>, name, <span class="hljs-built_in">type</span>, isDefault=<span class="hljs-literal">False</span></span>):</span><br>        self.__<span class="hljs-built_in">id</span> = <span class="hljs-built_in">id</span><br>        self.__name = name<br>        self.__<span class="hljs-built_in">type</span> = <span class="hljs-built_in">type</span><br>        self.__isDefault = isDefault<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;type: &quot;</span> + <span class="hljs-built_in">str</span>(self.__<span class="hljs-built_in">type</span>) + <span class="hljs-string">&quot;id: &quot;</span> + <span class="hljs-built_in">str</span>(self.__<span class="hljs-built_in">id</span>) + <span class="hljs-string">&quot;name: &quot;</span> + <span class="hljs-built_in">str</span>(<br>            self.__name) + <span class="hljs-string">&quot;isDefault: &quot;</span> + <span class="hljs-built_in">str</span>(self.__isDefault)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getId</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__<span class="hljs-built_in">id</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getNmae</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getType</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__<span class="hljs-built_in">type</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isDefault</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__isDefault<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceList</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__devices = []<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add</span>(<span class="hljs-params">self, deviceItem</span>):</span><br>        self.__devices.append(deviceItem)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getCount</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.__devices)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getByIdx</span>(<span class="hljs-params">self, idx</span>):</span><br>        <span class="hljs-keyword">if</span> idx &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> idx &gt;= self.getCount():<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">return</span> self.__devices[idx]<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getById</span>(<span class="hljs-params">self, <span class="hljs-built_in">id</span></span>):</span><br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> self.__devices:<br>            <span class="hljs-keyword">if</span> item.getId() == <span class="hljs-built_in">id</span>:<br>                <span class="hljs-keyword">return</span> item<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceMgr</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">enumerate</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">active</span>(<span class="hljs-params">self, deviceId</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getCurDeviceId</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpeakerMgr</span>(<span class="hljs-params">DeviceMgr</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__curDeviceId = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">enumerate</span>(<span class="hljs-params">self</span>):</span><br>        devices = DeviceList()<br>        devices.add(<br>            DeviceItem(<span class="hljs-string">&quot;37dd1024-843b-83a1-934c-81ac9230111&quot;</span>, <span class="hljs-string">&quot;Realtek HighDefinition Audio&quot;</span>, DeviceType.TypeSpeaker,<br>                       <span class="hljs-literal">True</span>))<br>        devices.add(<br>            DeviceItem(<span class="hljs-string">&quot;215a41c60-1313-24aa-1241-324ac3f445&quot;</span>, <span class="hljs-string">&quot;NVIDIA HighDefinition Audio&quot;</span>, DeviceType.TypeSpeaker,<br>                       <span class="hljs-literal">True</span>))<br>        <span class="hljs-keyword">return</span> devices<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">active</span>(<span class="hljs-params">self, deviceId</span>):</span><br>        self.__curDeviceId = deviceId<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getCurDeviceId</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__curDeviceId<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceUtil</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        self.__mgrs = &#123;DeviceType.TypeSpeaker: SpeakerMgr()&#125;<br>        <span class="hljs-comment"># self.__microphoneMgr =</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__getDeviceMgr</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span></span>):</span><br>        <span class="hljs-keyword">return</span> self.__mgrs[<span class="hljs-built_in">type</span>]<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getDeviceList</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span></span>):</span><br>        <span class="hljs-keyword">return</span> self.__getDeviceMgr(<span class="hljs-built_in">type</span>).<span class="hljs-built_in">enumerate</span>()<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">active</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span>, deviceId</span>):</span><br>        self.__getDeviceMgr(<span class="hljs-built_in">type</span>).active(deviceId)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getCurDeviceId</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span></span>):</span><br>        <span class="hljs-keyword">return</span> self.__getDeviceMgr(<span class="hljs-built_in">type</span>).getCurDeviceId()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    deviceUtil = DeviceUtil()<br>    deviceList = deviceUtil.getDeviceList(DeviceType.TypeSpeaker)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;麦克风设备列表：&quot;</span>)<br>    <span class="hljs-keyword">if</span> devDeviceItemiceList.getCount() &gt; <span class="hljs-number">0</span>:<br>        deviceUtil.active(DeviceType.TypeSpeaker, deviceList.getByIdx(<span class="hljs-number">0</span>).getId())<br><br>    <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, deviceList.getCount()):<br>        device = deviceList.getByIdx(idx)<br>        <span class="hljs-built_in">print</span>(device)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"当前使用的设备："</span> + deviceList.getById(deviceUtil.getCurDeviceId(DeviceType.TypeSpeaker)).getNmae())<br><br></code></pre></td></tr></table></figure></li>
<li><p>分析，上述代码是将DeviceMgr作为中介，在一对多的关系中，DeviceItem是多，DeviceUtil是1，DeviceMgr将一个类型的驱动聚合，提供给DeviceUtil用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs python"><code class="language-hljs python">DeviceItem<br>DeviceMgr<br>SpeakerMgr<br>DeviceUtil<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="4-装饰模式"><a href="#4-装饰模式" class="headerlink" title="4. 装饰模式"></a>4. 装饰模式</h2><ul>
<li><p>装饰模式，可以让类在不改变自身的前提下添加更多功能</p>
</li>
<li><p>装饰模式实现的主要地方在于装饰类继承被装饰类、去嵌套执行被装饰者的方法并且额外扩充功能</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self._name = name<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wear</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;着装：&quot;</span>)<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClothingDecorator</span>(<span class="hljs-params">Person</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, person</span>):</span><br>        self._decorated = person<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wear</span>(<span class="hljs-params">self</span>):</span><br>        self._decorated.wear()<br>        self.decorate()<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decorate</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CasulPantDecorator</span>(<span class="hljs-params">ClothingDecorator</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(person)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decorate</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;一条卡其色休闲裤&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    tony = Engineer(<span class="hljs-string">&quot;Tony&quot;</span>, <span class="hljs-string"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self._name = name<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wear</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;着装：&quot;</span>)<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClothingDecorator</span>(<span class="hljs-params">Person</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, person</span>):</span><br>        self._decorated = person<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wear</span>(<span class="hljs-params">self</span>):</span><br>        self._decorated.wear()<br>        self.decorate()<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decorate</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CasulPantDecorator</span>(<span class="hljs-params">ClothingDecorator</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(person)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decorate</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;一条卡其色休闲裤&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    tony = Engineer(<span class="hljs-string">&quot;Tony&quot;</span>, <span class="hljs-string">"客户端开发"</span>)<br>    pant = CasulPantDecorator(tony)<br>    belt = BeltDecorator(pant)<br>    shoes = LeatherShoesDecorator(belt)<br>    sweater = KnittedSweaterDecorator(shoes)<br>    glasses = GlassedDecorator(sweater)<br>    glasses.wear()<br></code></pre></td></tr></table></figure></li>
<li><p>主要代码，主要在这个ClothingDecorator类上，可以递归继承，调用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClothingDecorator</span>(<span class="hljs-params">Person</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, person</span>):</span><br>        self._decorated = person<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wear</span>(<span class="hljs-params"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClothingDecorator</span>(<span class="hljs-params">Person</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, person</span>):</span><br>        self._decorated = person<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wear</span>(<span class="hljs-params">self</span>):</span><br>        self._decorated.wear()<br>        self.decorate()<br><br><br>    	<br></code></pre></td></tr></table></figure></li>
<li><p>装饰器，单例模式装饰器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">singletonDecorator</span>(<span class="hljs-params">cls, *args, **kwargs</span>):</span><br>    instance = &#123;&#125;<br>    <span class="hljs-comment"># 创建一个字典，以类名作为键 实例作为值，当装饰器运行时先判断是否存在，如果存在则返回实例</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapperSingleton</span>(<span class="hljs-params">*args, **kwargs</span>):</span><br>        <span class="hljs-keyword">if</span> cls <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> instance:<br>            instance[cls] = cls(*args, **kwargs)<br>        <span class="hljs-keyword">return</span> instance[cls]<br>   	<br>    <span class="hljs-keyword"><code class="language-hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">singletonDecorator</span>(<span class="hljs-params">cls, *args, **kwargs</span>):</span><br>    instance = &#123;&#125;<br>    <span class="hljs-comment"># 创建一个字典，以类名作为键 实例作为值，当装饰器运行时先判断是否存在，如果存在则返回实例</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapperSingleton</span>(<span class="hljs-params">*args, **kwargs</span>):</span><br>        <span class="hljs-keyword">if</span> cls <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> instance:<br>            instance[cls] = cls(*args, **kwargs)<br>        <span class="hljs-keyword">return</span> instance[cls]<br>   	<br>    <span class="hljs-keyword">return</span> wrapperSingleton<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="5-单例模式"><a href="#5-单例模式" class="headerlink" title="5. 单例模式"></a>5. 单例模式</h2><ul>
<li><p>单例模式，全局唯一实例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBeaultifulGril</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span><br>    __instance = <span class="hljs-literal">None</span><br>    __isFirstInit = <span class="hljs-literal">False</span><br>	<br>    <span class="hljs-comment"># 魔术方法，调用前先判断是否已有实例</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">cls, name</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cls.__instance:<br>            MyBeaultifulGril.__instance = <span class="hljs-built_in">super</span>().__new__(cls)<br>        <span class="hljs-keyword">return</span> cls.__instance<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.__isFirstInit:<br>            self.__name = name<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;遇见&quot;</span> + name + <span class="hljs-string">&quot;, 我一见钟情&quot;</span>)<br>            self.__isFirstInit = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;遇见&quot;</span> + name + <span class="hljs-string">&quot;, 我置若罔闻！&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showMyHeart</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(self.__name + <span class="hljs-string">&quot;就是我心中的唯一！&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    jenny = MyBeaultifulGril(<span class="hljs-string">&quot;Jenney&quot;</span>)<br>    jenny.showMyHeart()<br>    <span class="hljs-built_in">print</span>()<br>    kimi = MyBeaultifulGril(<span class="hljs-string">&quot;kimi&quot;</span>)<br>    kimi.showMyHeart()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;id(jenny):&quot;</span>, <span class="hljs-built_in">id</span>(jenny), <span class="hljs-string">&quot;id(kimi)&quot;</span>, <span class="hljs-built_in"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBeaultifulGril</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span><br>    __instance = <span class="hljs-literal">None</span><br>    __isFirstInit = <span class="hljs-literal">False</span><br>	<br>    <span class="hljs-comment"># 魔术方法，调用前先判断是否已有实例</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">cls, name</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cls.__instance:<br>            MyBeaultifulGril.__instance = <span class="hljs-built_in">super</span>().__new__(cls)<br>        <span class="hljs-keyword">return</span> cls.__instance<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.__isFirstInit:<br>            self.__name = name<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;遇见&quot;</span> + name + <span class="hljs-string">&quot;, 我一见钟情&quot;</span>)<br>            self.__isFirstInit = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;遇见&quot;</span> + name + <span class="hljs-string">&quot;, 我置若罔闻！&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showMyHeart</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(self.__name + <span class="hljs-string">&quot;就是我心中的唯一！&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    jenny = MyBeaultifulGril(<span class="hljs-string">&quot;Jenney&quot;</span>)<br>    jenny.showMyHeart()<br>    <span class="hljs-built_in">print</span>()<br>    kimi = MyBeaultifulGril(<span class="hljs-string">&quot;kimi&quot;</span>)<br>    kimi.showMyHeart()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;id(jenny):&quot;</span>, <span class="hljs-built_in">id</span>(jenny), <span class="hljs-string">&quot;id(kimi)&quot;</span>, <span class="hljs-built_in">id</span>(kimi))<br></code></pre></td></tr></table></figure></li>
<li><p>主要代码，使用python内置的模式方法实现单例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment"># 魔术方法，调用前先判断是否已有实例</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">cls, name</span>):</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cls.__instance:<br>        MyBeaultifulGril.__instance = <span class="hljs-built_in">super</span>().__new__(cls)<br>    <span class="hljs-keyword"><code class="language-hljs python"><span class="hljs-comment"># 魔术方法，调用前先判断是否已有实例</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">cls, name</span>):</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cls.__instance:<br>        MyBeaultifulGril.__instance = <span class="hljs-built_in">super</span>().__new__(cls)<br>    <span class="hljs-keyword">return</span> cls.__instance<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="6-克隆模式"><a href="#6-克隆模式" class="headerlink" title="6.克隆模式"></a>6.克隆模式</h2><ul>
<li><p>克隆模式（也叫原型模式），主要用于克隆属性 ，python的克隆可以用类库来实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> copy <span class="hljs-keyword">import</span>  copy, deepcopy<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, age</span>):</span><br>        self.__name = name<br>        self.__age = age<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showMySelf</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是&quot;</span> + self.__name + <span class="hljs-string">&quot;,年龄&quot;</span> + <span class="hljs-built_in">str</span>(self.__age) + <span class="hljs-string">&quot;,&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">coding</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是码农，我用程序改变世界，Coding...&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reading</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;阅读是我快乐！知识是我成长！如饥似渴地阅读是生活的一部分....&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fallInLove</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;春风吹，月亮明，花前月下好相约....&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">clone</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> copy(self)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    tony = Person(<span class="hljs-string">&quot;Tony&quot;</span>, <span class="hljs-number">27</span>)<br>    tony.showMySelf()<br>    tony.coding()<br><br>    <span class="hljs-built_in">print</span>()<br><br>    tony1 = tony.clone()<br>    tony1.showMySelf()<br>    tony1.reading()<br><br>    <span class="hljs-built_in"><code class="language-hljs python"><span class="hljs-keyword">from</span> copy <span class="hljs-keyword">import</span>  copy, deepcopy<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, age</span>):</span><br>        self.__name = name<br>        self.__age = age<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showMySelf</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是&quot;</span> + self.__name + <span class="hljs-string">&quot;,年龄&quot;</span> + <span class="hljs-built_in">str</span>(self.__age) + <span class="hljs-string">&quot;,&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">coding</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是码农，我用程序改变世界，Coding...&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reading</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;阅读是我快乐！知识是我成长！如饥似渴地阅读是生活的一部分....&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fallInLove</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;春风吹，月亮明，花前月下好相约....&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">clone</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> copy(self)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    tony = Person(<span class="hljs-string">&quot;Tony&quot;</span>, <span class="hljs-number">27</span>)<br>    tony.showMySelf()<br>    tony.coding()<br><br>    <span class="hljs-built_in">print</span>()<br><br>    tony1 = tony.clone()<br>    tony1.showMySelf()<br>    tony1.reading()<br><br>    <span class="hljs-built_in">print</span>()<br><br>    tony2 = tony.clone()<br>    tony2.showMySelf()<br>    tony2.fallInLove()<br><br></code></pre></td></tr></table></figure>


<ul>
<li>浅拷贝只拷贝应用类型对象的指针（指向），不开被引用类型对象指向的值；深拷贝则同事拷贝引用类型对象及其指向的值。</li>
</ul>
</li>
</ul>
<h2 id="7-职责模式"><a href="#7-职责模式" class="headerlink" title="7. 职责模式"></a>7. 职责模式</h2><ul>
<li><p>职责模式 ，解耦请求和处理端，请求端只需要知道下一级是谁即可，处理端只需要处理在自己范围内的事即可。</p>
</li>
<li><p>注意点：设计好下级处理对象，下级对象根据条件匹配，如果相符则执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, dayoff, reason</span>):</span><br>        self.__name = name<br>        self.__dayoff = dayoff<br>        self.__reason = reason<br>        self.__leader = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getName</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getDayoff</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__dayoff<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getReason</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__reason<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setLeader</span>(<span class="hljs-params">self, leader</span>):</span><br>        self.__leader = leader<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">request</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s 申请请假 %d 天,请假事由： %s&quot;</span> % (self.__name, self.__dayoff, self.__reason))<br>        <span class="hljs-keyword">if</span> self.__leader <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self.__leader.handleRequest(self)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Manager</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        self.__name = name<br>        self.__title = title<br>        self._nextHandler = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getName</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTitle</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__title<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setNextHandle</span>(<span class="hljs-params">self, nextHandler</span>):</span><br>        self._nextHandler = nextHandler<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Supervisor</span>(<span class="hljs-params">Manager</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name, title)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">if</span> person.getDayoff() &lt;= <span class="hljs-number">2</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))<br><br>        <span class="hljs-keyword">if</span> self._nextHandler <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self._nextHandler.handleRequest(person)<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DepartmentManager</span>(<span class="hljs-params">Manager</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name, title)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">if</span> person.getDayoff() &gt; <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> person.getDayoff() &lt;= <span class="hljs-number">5</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))<br><br>        <span class="hljs-keyword">if</span> self._nextHandler <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self._nextHandler.handleRequest(person)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CEO</span>(<span class="hljs-params">Manager</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name, title)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">if</span> person.getDayoff() &gt; <span class="hljs-number">5</span> <span class="hljs-keyword">and</span> person.getDayoff() &lt;= <span class="hljs-number">22</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))<br><br>        <span class="hljs-keyword">if</span> self._nextHandler <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self._nextHandler.handleRequest(person)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Administrator</span>(<span class="hljs-params">Manager</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        <span class="hljs-built_in">super</span>().__init    <span class="hljs-comment"># 魔术方法，调用前先判断是否已有实例</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">cls, name</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cls.__instance:<br>            MyBeaultifulGril.__instance = <span class="hljs-built_in">super</span>().__new__(cls)<br>        <span class="hljs-keyword">return</span> cls.__instance__(name, title)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s 的请假申请已审核，情况属实！已备案处理，处理人：%s(%s)\n&quot;</span> % (person.getName(), self.getName(), self.getTitle()))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    directLeader = Supervisor(<span class="hljs-string">&quot;Eren&quot;</span>, <span class="hljs-string">&quot;客户端研发部经理&quot;</span>)<br>    departmentLeader = DepartmentManager(<span class="hljs-string">&quot;Eric&quot;</span>, <span class="hljs-string">&quot;技术研发中心总监&quot;</span>)<br>    ceo = CEO(<span class="hljs-string">&quot;Helen&quot;</span>, <span class="hljs-string">&quot;创新文化公司CEO&quot;</span>)<br>    administrator = Administrator(<span class="hljs-string">&quot;Nina&quot;</span>, <span class="hljs-string">&quot;行政中心总监&quot;</span>)<br>    directLeader.setNextHandle(departmentLeader)<br>    departmentLeader.setNextHandle(ceo)<br>    ceo.setNextHandle(administrator)<br><br>    sunny = Person(<span class="hljs-string">&quot;sunny&quot;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;参加MDCC大会&quot;</span>)<br>    sunny.setLeader(directLeader)<br>    sunny.request()<br><br>    tony = Person(<span class="hljs-string">&quot;tony&quot;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;家里有紧急事情！&quot;</span>)<br>    tony.setLeader(directLeader)<br>    tony.request()<br><br>    pony = Person(<span class="hljs-string">&quot;Pony&quot;</span>, <span class="hljs-number">15</span>, <span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, dayoff, reason</span>):</span><br>        self.__name = name<br>        self.__dayoff = dayoff<br>        self.__reason = reason<br>        self.__leader = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getName</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getDayoff</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__dayoff<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getReason</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__reason<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setLeader</span>(<span class="hljs-params">self, leader</span>):</span><br>        self.__leader = leader<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">request</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s 申请请假 %d 天,请假事由： %s&quot;</span> % (self.__name, self.__dayoff, self.__reason))<br>        <span class="hljs-keyword">if</span> self.__leader <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self.__leader.handleRequest(self)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Manager</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        self.__name = name<br>        self.__title = title<br>        self._nextHandler = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getName</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getTitle</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__title<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setNextHandle</span>(<span class="hljs-params">self, nextHandler</span>):</span><br>        self._nextHandler = nextHandler<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Supervisor</span>(<span class="hljs-params">Manager</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name, title)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">if</span> person.getDayoff() &lt;= <span class="hljs-number">2</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))<br><br>        <span class="hljs-keyword">if</span> self._nextHandler <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self._nextHandler.handleRequest(person)<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DepartmentManager</span>(<span class="hljs-params">Manager</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name, title)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">if</span> person.getDayoff() &gt; <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> person.getDayoff() &lt;= <span class="hljs-number">5</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))<br><br>        <span class="hljs-keyword">if</span> self._nextHandler <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self._nextHandler.handleRequest(person)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CEO</span>(<span class="hljs-params">Manager</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name, title)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">if</span> person.getDayoff() &gt; <span class="hljs-number">5</span> <span class="hljs-keyword">and</span> person.getDayoff() &lt;= <span class="hljs-number">22</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))<br><br>        <span class="hljs-keyword">if</span> self._nextHandler <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self._nextHandler.handleRequest(person)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Administrator</span>(<span class="hljs-params">Manager</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        <span class="hljs-built_in">super</span>().__init    <span class="hljs-comment"># 魔术方法，调用前先判断是否已有实例</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">cls, name</span>):</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cls.__instance:<br>            MyBeaultifulGril.__instance = <span class="hljs-built_in">super</span>().__new__(cls)<br>        <span class="hljs-keyword">return</span> cls.__instance__(name, title)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s 的请假申请已审核，情况属实！已备案处理，处理人：%s(%s)\n&quot;</span> % (person.getName(), self.getName(), self.getTitle()))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    directLeader = Supervisor(<span class="hljs-string">&quot;Eren&quot;</span>, <span class="hljs-string">&quot;客户端研发部经理&quot;</span>)<br>    departmentLeader = DepartmentManager(<span class="hljs-string">&quot;Eric&quot;</span>, <span class="hljs-string">&quot;技术研发中心总监&quot;</span>)<br>    ceo = CEO(<span class="hljs-string">&quot;Helen&quot;</span>, <span class="hljs-string">&quot;创新文化公司CEO&quot;</span>)<br>    administrator = Administrator(<span class="hljs-string">&quot;Nina&quot;</span>, <span class="hljs-string">&quot;行政中心总监&quot;</span>)<br>    directLeader.setNextHandle(departmentLeader)<br>    departmentLeader.setNextHandle(ceo)<br>    ceo.setNextHandle(administrator)<br><br>    sunny = Person(<span class="hljs-string">&quot;sunny&quot;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;参加MDCC大会&quot;</span>)<br>    sunny.setLeader(directLeader)<br>    sunny.request()<br><br>    tony = Person(<span class="hljs-string">&quot;tony&quot;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;家里有紧急事情！&quot;</span>)<br>    tony.setLeader(directLeader)<br>    tony.request()<br><br>    pony = Person(<span class="hljs-string">&quot;Pony&quot;</span>, <span class="hljs-number">15</span>, <span class="hljs-string">"出国深造。"</span>)<br>    pony.setLeader(directLeader)<br>    pony.request()<br><br></code></pre></td></tr></table></figure></li>
<li><p>主要代码，链上的各个节点都设置好下一级的处理对象，各节点上的对象只有处理的条件符合时才处理。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Manager</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        self._nextHandler = <span class="hljs-literal">None</span><br>        <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setNextHandle</span>(<span class="hljs-params">self, nextHandler</span>):</span><br>        self._nextHandler = nextHandler<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">pass</span><br>        <br>        <span class="hljs-keyword">if</span> self._nextHandler <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Manager</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, title</span>):</span><br>        self._nextHandler = <span class="hljs-literal">None</span><br>        <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setNextHandle</span>(<span class="hljs-params">self, nextHandler</span>):</span><br>        self._nextHandler = nextHandler<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-params">self, person</span>):</span><br>        <span class="hljs-keyword">pass</span><br>        <br>        <span class="hljs-keyword">if</span> self._nextHandler <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self._nextHandler.handleRequest(person)<br><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="8-代理模式"><a href="#8-代理模式" class="headerlink" title="8. 代理模式"></a>8. 代理模式</h2><ul>
<li><p>代理模式，间接执行真正的主体，协调双方也方便控制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReceiveParcel</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getName</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TonyReception</span>(<span class="hljs-params">ReceiveParcel</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, phoneNum</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self.__phoneNum = phoneNum<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPhoneNum</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__phoneNum<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;货物主人： %s ,手机号： %s &quot;</span> % (self.getName(), self.getPhoneNum()))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;接收到一个包裹，包裹内容： %s &quot;</span> % parcelContent)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WendyReception</span>(<span class="hljs-params">ReceiveParcel</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, receiver</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self.__receiver = receiver<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="hljs-string">&quot; &quot;</span> ))<br>        <span class="hljs-keyword">if</span> self.__receiver <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self.__receiver.receive(parcelContent)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    tony = TonyReception(<span class="hljs-string">&quot;Tony&quot;</span>, <span class="hljs-string">&quot;18888888888&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Tony接受：&quot;</span>)<br>    tony.receive(<span class="hljs-string">&quot;雪地靴&quot;</span>)<br>    <span class="hljs-built_in">print</span>()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wendy代收：&quot;</span>)<br>    wendy = WendyReception(<span class="hljs-string">&quot;Wendy&quot;</span>, tony)<br>    wendy.receive(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReceiveParcel</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getName</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TonyReception</span>(<span class="hljs-params">ReceiveParcel</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, phoneNum</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self.__phoneNum = phoneNum<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPhoneNum</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__phoneNum<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;货物主人： %s ,手机号： %s &quot;</span> % (self.getName(), self.getPhoneNum()))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;接收到一个包裹，包裹内容： %s &quot;</span> % parcelContent)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WendyReception</span>(<span class="hljs-params">ReceiveParcel</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, receiver</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self.__receiver = receiver<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="hljs-string">&quot; &quot;</span> ))<br>        <span class="hljs-keyword">if</span> self.__receiver <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self.__receiver.receive(parcelContent)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    tony = TonyReception(<span class="hljs-string">&quot;Tony&quot;</span>, <span class="hljs-string">&quot;18888888888&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Tony接受：&quot;</span>)<br>    tony.receive(<span class="hljs-string">&quot;雪地靴&quot;</span>)<br>    <span class="hljs-built_in">print</span>()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wendy代收：&quot;</span>)<br>    wendy = WendyReception(<span class="hljs-string">&quot;Wendy&quot;</span>, tony)<br>    wendy.receive(<span class="hljs-string">"雪地靴"</span>)<br></code></pre></td></tr></table></figure></li>
<li><p>主要代码，代理类传入需要代理的对象，在执行代理对象的方法之前可以进行控制处理。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WendyReception</span>(<span class="hljs-params">ReceiveParcel</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, receiver</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self.__receiver = receiver<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="hljs-string">&quot; &quot;</span> ))<br>        <span class="hljs-keyword">if</span> self.__receiver <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WendyReception</span>(<span class="hljs-params">ReceiveParcel</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, receiver</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self.__receiver = receiver<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="hljs-string">&quot; &quot;</span> ))<br>        <span class="hljs-keyword">if</span> self.__receiver <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self.__receiver.receive(parcelContent)<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="9-外观模式"><a href="#9-外观模式" class="headerlink" title="9. 外观模式"></a>9. 外观模式</h2><ul>
<li><p>外观模式，也叫门户模式，将多个复杂的接口封装成一个，以供用户使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Register</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">register</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;活动中心： %s 同学报道成功！&quot;</span> % name)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Payment</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pay</span>(<span class="hljs-params">self, name, money</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;缴费中心：收到%s同学%s元付款，缴费成功！&quot;</span> % (name, money))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DormitoryManagementCenter</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">provideLivingGoods</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;生活中心：%s 同学的生活用品已发放。&quot;</span> % name)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dormitory</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">meetRoommate</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;宿舍： 大家好！这是刚来的 %s同学，是你们未来需要共读四年的室友！相互认识一下....&quot;</span> % name)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Volunteer</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__register = Register()<br>        self.__payment = Payment()<br>        self.__lifeCenter = DormitoryManagementCenter()<br>        self.__dormintory = Dormitory()<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">welcomeFreshmen</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;您好，%s同学！ 我是新生报到的志愿者%s,我将带你完成整个报道流程。&quot;</span> % (name, self.__name))<br>        self.__register.register(name)<br>        self.__payment.pay(name, <span class="hljs-number">10000</span>)<br>        self.__lifeCenter.provideLivingGoods(name)<br>        self.__dormintory.meetRoommate(name)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    volunteer = Volunteer(<span class="hljs-string">&quot;Frank&quot;</span>)<br>    volunteer.welcomeFreshmen(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Register</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">register</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;活动中心： %s 同学报道成功！&quot;</span> % name)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Payment</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pay</span>(<span class="hljs-params">self, name, money</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;缴费中心：收到%s同学%s元付款，缴费成功！&quot;</span> % (name, money))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DormitoryManagementCenter</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">provideLivingGoods</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;生活中心：%s 同学的生活用品已发放。&quot;</span> % name)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dormitory</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">meetRoommate</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;宿舍： 大家好！这是刚来的 %s同学，是你们未来需要共读四年的室友！相互认识一下....&quot;</span> % name)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Volunteer</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__register = Register()<br>        self.__payment = Payment()<br>        self.__lifeCenter = DormitoryManagementCenter()<br>        self.__dormintory = Dormitory()<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">welcomeFreshmen</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;您好，%s同学！ 我是新生报到的志愿者%s,我将带你完成整个报道流程。&quot;</span> % (name, self.__name))<br>        self.__register.register(name)<br>        self.__payment.pay(name, <span class="hljs-number">10000</span>)<br>        self.__lifeCenter.provideLivingGoods(name)<br>        self.__dormintory.meetRoommate(name)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    volunteer = Volunteer(<span class="hljs-string">&quot;Frank&quot;</span>)<br>    volunteer.welcomeFreshmen(<span class="hljs-string">"tony"</span>)<br></code></pre></td></tr></table></figure></li>
<li><p>主要代码，外观模式很像中介模式，将本来一对多的关系转换为一对一，由外观类去处理多，区别在于外观模式注重提供统一的对外接口，中介模式注重于双方的交互。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Volunteer</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Volunteer</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__register = Register()<br>        self.__payment = Payment()<br>        self.__lifeCenter = DormitoryManagementCenter()<br>        self.__dormintory = Dormitory()<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="10-迭代模式"><a href="#10-迭代模式" class="headerlink" title="10 迭代模式"></a>10 迭代模式</h2><ul>
<li><p>迭代模式，提供一种对象的顺序访问方式，Python对迭代支持的非常好（for …. in）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__num = <span class="hljs-number">0</span><br>        self.__clinics = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getName</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">register</span>(<span class="hljs-params">self, system</span>):</span><br>        system.pushCustomer(self)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setNum</span>(<span class="hljs-params">self, num</span>):</span><br>        self.__num = num<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getNum</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__num<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setClinic</span>(<span class="hljs-params">self, clinic</span>):</span><br>        self.__clinics = clinic<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getClinic</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__clinics<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NumeralIterator</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, data</span>):</span><br>        self.__data = data<br>        self.__curIdx = -<span class="hljs-number">1</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">next</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.__curIdx &lt; <span class="hljs-built_in">len</span>(self.__data) -<span class="hljs-number">1</span>:<br>            self.__curIdx += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">current</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__data[self.__curIdx] <span class="hljs-keyword">if</span> self.__curIdx &lt; <span class="hljs-built_in">len</span>(self.__data) <span class="hljs-keyword">and</span> self.__curIdx &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NumberalSystem</span>:</span><br>    __clinics = (<span class="hljs-string">&quot;1号诊室&quot;</span>, <span class="hljs-string">&quot;2号正式诊室&quot;</span>, <span class="hljs-string">&quot;3号正式诊室&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__customers = []<br>        self.__curNum = <span class="hljs-number">0</span><br>        self.__name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pushCustomer</span>(<span class="hljs-params">self, customer</span>):</span><br>        customer.setNum(self.__curNum + <span class="hljs-number">1</span>)<br>        click = NumberalSystem.__clinics[self.__curNum % <span class="hljs-built_in">len</span>(NumberalSystem.__clinics)]<br>        customer.setClinic(click)<br>        self.__curNum += <span class="hljs-number">1</span><br>        self.__customers.append(customer)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s 您好！ 您已在 %s 成功挂号，序号：%04d，请耐心等待！&quot;</span> % (customer.getName(), self.__name, customer.getNum()))<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getIterator</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> NumeralIterator(self.__customers)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    numeralSystem = Nclass Volunteer:<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__register = Register()<br>        self.__payment = Payment()<br>        self.__lifeCenter = DormitoryManagementCenter()<br>        self.__dormintory = Dormitory()umberalSystem(<span class="hljs-string">&quot;挂号台&quot;</span>)<br>    lily = Customer(<span class="hljs-string">&quot;Lily&quot;</span>)<br>    lily.register(numeralSystem)<br>    pony = Customer(<span class="hljs-string">&quot;Pony&quot;</span>)<br>    pony.register(numeralSystem)<br>    nick = Customer(<span class="hljs-string">&quot;Nick&quot;</span>)<br>    nick.register(numeralSystem)<br>    tony = Customer(<span class="hljs-string">&quot;Tony&quot;</span>)<br>    tony.register(numeralSystem)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WendyReception</span>(<span class="hljs-params">ReceiveParcel</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, receiver</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self.__receiver = receiver<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="hljs-string">&quot; &quot;</span> ))<br>        <span class="hljs-keyword">if</span> self.__receiver <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self.__receiver.receive(parcelContent)<br>    <span class="hljs-built_in">print</span>()<br><br>    iterator = numeralSystem.getIterator()<br>    <span class="hljs-keyword">while</span>(iterator.<span class="hljs-built_in">next</span>()):<br>        customer = iterator.current()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__num = <span class="hljs-number">0</span><br>        self.__clinics = <span class="hljs-literal">None</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getName</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">register</span>(<span class="hljs-params">self, system</span>):</span><br>        system.pushCustomer(self)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setNum</span>(<span class="hljs-params">self, num</span>):</span><br>        self.__num = num<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getNum</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__num<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setClinic</span>(<span class="hljs-params">self, clinic</span>):</span><br>        self.__clinics = clinic<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getClinic</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__clinics<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NumeralIterator</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, data</span>):</span><br>        self.__data = data<br>        self.__curIdx = -<span class="hljs-number">1</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">next</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.__curIdx &lt; <span class="hljs-built_in">len</span>(self.__data) -<span class="hljs-number">1</span>:<br>            self.__curIdx += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">current</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__data[self.__curIdx] <span class="hljs-keyword">if</span> self.__curIdx &lt; <span class="hljs-built_in">len</span>(self.__data) <span class="hljs-keyword">and</span> self.__curIdx &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NumberalSystem</span>:</span><br>    __clinics = (<span class="hljs-string">&quot;1号诊室&quot;</span>, <span class="hljs-string">&quot;2号正式诊室&quot;</span>, <span class="hljs-string">&quot;3号正式诊室&quot;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__customers = []<br>        self.__curNum = <span class="hljs-number">0</span><br>        self.__name = name<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pushCustomer</span>(<span class="hljs-params">self, customer</span>):</span><br>        customer.setNum(self.__curNum + <span class="hljs-number">1</span>)<br>        click = NumberalSystem.__clinics[self.__curNum % <span class="hljs-built_in">len</span>(NumberalSystem.__clinics)]<br>        customer.setClinic(click)<br>        self.__curNum += <span class="hljs-number">1</span><br>        self.__customers.append(customer)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s 您好！ 您已在 %s 成功挂号，序号：%04d，请耐心等待！&quot;</span> % (customer.getName(), self.__name, customer.getNum()))<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getIterator</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> NumeralIterator(self.__customers)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    numeralSystem = Nclass Volunteer:<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self.__name = name<br>        self.__register = Register()<br>        self.__payment = Payment()<br>        self.__lifeCenter = DormitoryManagementCenter()<br>        self.__dormintory = Dormitory()umberalSystem(<span class="hljs-string">&quot;挂号台&quot;</span>)<br>    lily = Customer(<span class="hljs-string">&quot;Lily&quot;</span>)<br>    lily.register(numeralSystem)<br>    pony = Customer(<span class="hljs-string">&quot;Pony&quot;</span>)<br>    pony.register(numeralSystem)<br>    nick = Customer(<span class="hljs-string">&quot;Nick&quot;</span>)<br>    nick.register(numeralSystem)<br>    tony = Customer(<span class="hljs-string">&quot;Tony&quot;</span>)<br>    tony.register(numeralSystem)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WendyReception</span>(<span class="hljs-params">ReceiveParcel</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name, receiver</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self.__receiver = receiver<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive</span>(<span class="hljs-params">self, parcelContent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="hljs-string">&quot; &quot;</span> ))<br>        <span class="hljs-keyword">if</span> self.__receiver <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self.__receiver.receive(parcelContent)<br>    <span class="hljs-built_in">print</span>()<br><br>    iterator = numeralSystem.getIterator()<br>    <span class="hljs-keyword">while</span>(iterator.<span class="hljs-built_in">next</span>()):<br>        customer = iterator.current()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"下一位病人 %04d(%s) 请到 %s 就诊。"</span> % (customer.getNum(), customer.getName(), customer.getClinic()))<br></code></pre></td></tr></table></figure></li>
<li><p>主要代码，没什么好说的，在其他语言里面这是一种数据、对象的遍历方式，在python里面也是，只不过python内置很多迭代器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NumeralIterator</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, data</span>):</span><br>        self.__data = data<br>        self.__curIdx = -<span class="hljs-number">1</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">next</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.__curIdx &lt; <span class="hljs-built_in">len</span>(self.__data) -<span class="hljs-number">1</span>:<br>            self.__curIdx += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">current</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__data[self.__curIdx] <span class="hljs-keyword">if</span> self.__curIdx &lt; <span class="hljs-built_in">len</span>(self.__data) <span class="hljs-keyword">and</span> self.__curIdx &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-literal"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NumeralIterator</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, data</span>):</span><br>        self.__data = data<br>        self.__curIdx = -<span class="hljs-number">1</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">next</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.__curIdx &lt; <span class="hljs-built_in">len</span>(self.__data) -<span class="hljs-number">1</span>:<br>            self.__curIdx += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">current</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.__data[self.__curIdx] <span class="hljs-keyword">if</span> self.__curIdx &lt; <span class="hljs-built_in">len</span>(self.__data) <span class="hljs-keyword">and</span> self.__curIdx &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="11-组合模式"><a href="#11-组合模式" class="headerlink" title="11 组合模式"></a>11 组合模式</h2><ul>
<li><p>组合模式，复杂的功能可以分解成多个组件，组件之间相互组合构成更多功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerComponent</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self._name = name<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent=<span class="hljs-string">&quot; &quot;</span></span>):</span><br>        <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isComposite</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">self, indent=<span class="hljs-string">&quot; &quot;</span></span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s%s 准备开始工作...&quot;</span> % (indent, self._name))<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shutdown</span>(<span class="hljs-params">self, indent=<span class="hljs-string">&quot; &quot;</span></span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s%s 即将结束工作...&quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CPU</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%sCPU:%s,可以进行告诉运算。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MemoryCard</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s内存:%s,可以缓存数据，读写更快。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HardDisk</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s硬盘:%s,可以永久存储数据，容量大。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GraphicsCard</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s显卡:%s,可以高速计算和处理图形图像。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Battery</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s电源:%s,可以持续给主板和外界配件供电。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Fan</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s风扇:%s,可以持续给主板和外界配件供电。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Displayer</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s显示器:%s,可以显示界面和打游戏。 &quot;</span> % (indent, self._name))<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerComposite</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self._components = []<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s,由一下部件组成：&quot;</span> % self._name)<br>        indent += <span class="hljs-string">&#x27;\t&#x27;</span><br>        <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> self._components:<br>            element.showInfo(indent)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isComposite</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">addComposite</span>(<span class="hljs-params">self, component</span>):</span><br>        self._components.append(component)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">removeComponent</span>(<span class="hljs-params">self, component</span>):</span><br>        self._components.remove(component)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">super</span>().startup(indent)<br>        indent += <span class="hljs-string">&#x27;\t&#x27;</span><br>        <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> self._components:<br>            element.startup(indent)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shutdown</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">super</span>().shutdown(indent)<br>        indent += <span class="hljs-string">&#x27;\t&#x27;</span><br>        <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> self._components:<br>            element.shutdown(indent)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainBoard</span>(<span class="hljs-params">ComputerComposite</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span>组合模式<br>        <span class="hljs-built_in">print</span>(indent + <span class="hljs-string">&quot;主板：&quot;</span>, end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-built_in">super</span>().showInfo(indent)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerCase</span>(<span class="hljs-params">ComputerComposite</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(indent + <span class="hljs-string">&quot;机箱:&quot;</span>, end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-built_in">super</span>().showInfo(indent)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Computer</span>(<span class="hljs-params">ComputerComposite</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)组合模式<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(indent, <span class="hljs-string">&quot;电脑：&quot;</span>, end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-built_in">super</span>().showInfo(indent)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    mainBoard = MainBoard(<span class="hljs-string">&quot;GIGABYTE Z179M M-ATX&quot;</span>)<br>    mainBoard.addComposite(CPU(<span class="hljs-string">&quot;Intel Core I5-5500k&quot;</span>))<br>    mainBoard.addComposite(MemoryCard(<span class="hljs-string">&quot;Kingston Fury DDR4&quot;</span>))<br>    mainBoard.addComposite(HardDisk(<span class="hljs-string">&quot;Kingston V300&quot;</span>))<br>    mainBoard.addComposite(GraphicsCard(<span class="hljs-string">&quot;Colorful iGame750&quot;</span>))<br><br>    computerCase = ComputerCase(<span class="hljs-string">&quot;SAMA MATX&quot;</span>)<br>    computerCase.addComposite(mainBoard)<br>    computerCase.addComposite(Battery(<span class="hljs-string">&quot;Anter VP 450P&quot;</span>))<br>    computerCase.addComposite(Fan(<span class="hljs-string">&quot;DEEPCOOL 120T&quot;</span>))<br><br>    computer = Computer(<span class="hljs-string">&quot;Tony DIV 电脑&quot;</span>)<br>    computer.addComposite(computerCase)<br>    computer.addComposite(Displayer(<span class="hljs-string">&quot;AOC Lv24XIP&quot;</span>))<br><br>    computer.showInfo(<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n 开机过程&quot;</span>)<br>    computer.startup(<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n 关机过程&quot;</span>)<br>    computer.shutdown(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerComponent</span>(<span class="hljs-params">metaclass=ABCMeta</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        self._name = name<br><br><span class="hljs-meta">    @abstractmethod</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent=<span class="hljs-string">&quot; &quot;</span></span>):</span><br>        <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isComposite</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">self, indent=<span class="hljs-string">&quot; &quot;</span></span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s%s 准备开始工作...&quot;</span> % (indent, self._name))<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shutdown</span>(<span class="hljs-params">self, indent=<span class="hljs-string">&quot; &quot;</span></span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s%s 即将结束工作...&quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CPU</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%sCPU:%s,可以进行告诉运算。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MemoryCard</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s内存:%s,可以缓存数据，读写更快。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HardDisk</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s硬盘:%s,可以永久存储数据，容量大。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GraphicsCard</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s显卡:%s,可以高速计算和处理图形图像。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Battery</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s电源:%s,可以持续给主板和外界配件供电。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Fan</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s风扇:%s,可以持续给主板和外界配件供电。 &quot;</span> % (indent, self._name))<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Displayer</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s显示器:%s,可以显示界面和打游戏。 &quot;</span> % (indent, self._name))<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerComposite</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self._components = []<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s,由一下部件组成：&quot;</span> % self._name)<br>        indent += <span class="hljs-string">&#x27;\t&#x27;</span><br>        <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> self._components:<br>            element.showInfo(indent)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">isComposite</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">addComposite</span>(<span class="hljs-params">self, component</span>):</span><br>        self._components.append(component)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">removeComponent</span>(<span class="hljs-params">self, component</span>):</span><br>        self._components.remove(component)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">super</span>().startup(indent)<br>        indent += <span class="hljs-string">&#x27;\t&#x27;</span><br>        <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> self._components:<br>            element.startup(indent)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shutdown</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">super</span>().shutdown(indent)<br>        indent += <span class="hljs-string">&#x27;\t&#x27;</span><br>        <span class="hljs-keyword">for</span> element <span class="hljs-keyword">in</span> self._components:<br>            element.shutdown(indent)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainBoard</span>(<span class="hljs-params">ComputerComposite</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span>组合模式<br>        <span class="hljs-built_in">print</span>(indent + <span class="hljs-string">&quot;主板：&quot;</span>, end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-built_in">super</span>().showInfo(indent)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerCase</span>(<span class="hljs-params">ComputerComposite</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(indent + <span class="hljs-string">&quot;机箱:&quot;</span>, end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-built_in">super</span>().showInfo(indent)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Computer</span>(<span class="hljs-params">ComputerComposite</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)组合模式<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br>        <span class="hljs-built_in">print</span>(indent, <span class="hljs-string">&quot;电脑：&quot;</span>, end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-built_in">super</span>().showInfo(indent)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    mainBoard = MainBoard(<span class="hljs-string">&quot;GIGABYTE Z179M M-ATX&quot;</span>)<br>    mainBoard.addComposite(CPU(<span class="hljs-string">&quot;Intel Core I5-5500k&quot;</span>))<br>    mainBoard.addComposite(MemoryCard(<span class="hljs-string">&quot;Kingston Fury DDR4&quot;</span>))<br>    mainBoard.addComposite(HardDisk(<span class="hljs-string">&quot;Kingston V300&quot;</span>))<br>    mainBoard.addComposite(GraphicsCard(<span class="hljs-string">&quot;Colorful iGame750&quot;</span>))<br><br>    computerCase = ComputerCase(<span class="hljs-string">&quot;SAMA MATX&quot;</span>)<br>    computerCase.addComposite(mainBoard)<br>    computerCase.addComposite(Battery(<span class="hljs-string">&quot;Anter VP 450P&quot;</span>))<br>    computerCase.addComposite(Fan(<span class="hljs-string">&quot;DEEPCOOL 120T&quot;</span>))<br><br>    computer = Computer(<span class="hljs-string">&quot;Tony DIV 电脑&quot;</span>)<br>    computer.addComposite(computerCase)<br>    computer.addComposite(Displayer(<span class="hljs-string">&quot;AOC Lv24XIP&quot;</span>))<br><br>    computer.showInfo(<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n 开机过程&quot;</span>)<br>    computer.startup(<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n 关机过程&quot;</span>)<br>    computer.shutdown(<span class="hljs-string">""</span>)<br><br></code></pre></td></tr></table></figure></li>
<li><p>主要代码 ，组合模式注重于将多个零件相互组合成一个复杂的系统。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerComposite</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self._components = []<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">addComposite</span>(<span class="hljs-params">self, component</span>):</span><br>        self._components.append(component)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">removeComponent</span>(<span class="hljs-params">self, component</span>):</span><br>        self._components.remove(component)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">self, indent</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shutdown</span>(<span class="hljs-params"><code class="language-hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerComposite</span>(<span class="hljs-params">ComputerComponent</span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span><br>        <span class="hljs-built_in">super</span>().__init__(name)<br>        self._components = []<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showInfo</span>(<span class="hljs-params">self, indent</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">addComposite</span>(<span class="hljs-params">self, component</span>):</span><br>        self._components.append(component)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">removeComponent</span>(<span class="hljs-params">self, component</span>):</span><br>        self._components.remove(component)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">self, indent</span>):</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shutdown</span>(<span class="hljs-params">self, indent</span>):</span><br><br></code></pre></td></tr></table></figure></li>
</ul>
</div><script src="/js/jquery.min.js"></script><script src="/js/main.js"></script></body></html>