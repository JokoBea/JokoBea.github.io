<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>如何混一个C2 | Hurn's Blog</title><meta name="description" content="如何混一个C2 - Hurn"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Hurn's Blog"><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><div class="wrap"><header><h1 class="branding"><a href="/" title="Hurn's Blog"><img class="logo-image" src="/logo.png" alt="logo"></a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/Dreyer" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">如何混一个C2</h1><div class="post-info"><a></a>2022-08-20</div><div class="post-content"><p>一直在用CS，倒不是这个东西不好用，是太好用了大家都喜欢用，功能很全、很丰富，可视化的界面、可定制的profile、非常多的社区插件、截图、进程注入、凭证导出、横向移动等功能…</p>
<p>所以大家都喜欢用，大家都喜欢研究，杀软也很喜欢研究，加了很多特征库，改完一版本到什么演练玩了两天就被杀了或者传沙箱分析了，改了改去就很烦…  对于个人来讲，因为用这个东西，去搞很多东西跟人家专门搞这个的人去对抗，浪费时间不太值得，主要是不想在这个方面专门去研究很深，只是想能满足个人需求即可，另外CS很多功都不是刚需，都有替代品，这就是为什么要再混个C2了。</p>
<p>真实原因是最近太闲了。</p>
<p>可预见的坑会很多，但是太闲了，干了再说…</p>
<p>技术语言： 客户端：C艹  +  Server后端: Java + html/css （Web界面）</p>
<blockquote>
<p>不选Go是因为Github上已有CobaltStrike的Go Beacon ，在Linux、Darwin系统上够用，所以没必要再搞。</p>
<p>为什么用C艹，因为之前写过shellcode好转换…  </p>
<p>为什么不用C#，因为不会…</p>
<p>为什么用混呢，因为只想写写能用，不求多牛逼…（只要我没追求，就没有人能卷我..）</p>
</blockquote>
<p>理想情况:</p>
<ol>
<li>可视化的命令、文件界面管理，支持云函数等隐藏姿势</li>
<li>支持shellcode + ReflectiveDLL，不会落地真正的DLL，最好还能加密一层</li>
<li>有一定的自动权限维持功能</li>
</ol>
<p>day1  8.20</p>
<ul>
<li>服务端完成的任务接受、下发，心跳</li>
<li>客户端完成心跳管理和回连</li>
</ul>
<p>day2  8.21</p>
<ul>
<li>完成执行命令功能</li>
<li>调好了crypto++库</li>
</ul>
<p>day3 8.22</p>
<ul>
<li>自闭Vue3 + ElementUIPlus</li>
<li>转头Vue2 + ElementUI</li>
</ul>
<p>day4 8.23 </p>
<ul>
<li>写好了大致的界面，正在适配任务</li>
<li>搞定了Vue组件通信…</li>
</ul>
<p>day5 8.24</p>
<ul>
<li>适配了命令执行，问题是用了crypto++这个库，加密中文会乱码</li>
<li>写好了文件管理界面，正在适配任务</li>
</ul>
<p>day6-7 8.25, 8.26</p>
<ul>
<li>主要在写文件管理的界面，这个前端是真难写，特别还要写出CS文件管理的那种感觉是真的费劲。目前问题是左边目录框数据没去重，右边文件框数据已去重。去重挺费劲的，要保留记录，要最新的记录，要动态更新…</li>
</ul>
<blockquote>
<p> 写了7天，发现工作量最大的是写前端UI…</p>
<p>明天看看搞完去重，把上传下载写完。</p>
</blockquote>
<p>day8 8.27</p>
<ul>
<li>完成了shellcode远程加载dll</li>
</ul>
<blockquote>
<p>先这样，大体都完成了，剩下的功能再慢慢加，后续可写的还挺多，hook sleep 混淆dll、流量处理、一些其他功能如截图、键盘记录、权限维持….</p>
</blockquote>
<p>效果图：</p>
<p><img src="/2022/08/20/%E5%A6%82%E4%BD%95%E6%B7%B7%E4%B8%80%E4%B8%AAC2/test-1610544.gif" alt="test"></p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2022/08/21/CryptoPP/">prev</a><a class="next" href="/2022/07/05/Java/Springboot%E5%88%A9%E7%94%A8/">next</a></div><div class="copyright"><p>&copy; 2023 <a href="http://example.com">Hurn</a>.<br>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/Dreyer/hexo-theme-artemis" target="_blank">Artemis</a>.</p></div></footer></div></body></html>