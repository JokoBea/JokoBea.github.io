<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>creakeme1 | Hurn's Blog</title><meta name="description" content="creakeme1 - Hurn"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Hurn's Blog"><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><div class="wrap"><header><h1 class="branding"><a href="/" title="Hurn's Blog"><img class="logo-image" src="/logo.png" alt="logo"></a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/Dreyer" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">creakeme1</h1><div class="post-info"><a></a>2022-05-26</div><div class="post-content"><h1 id="1-Acid-Burn"><a href="#1-Acid-Burn" class="headerlink" title="1. Acid Burn"></a>1. Acid Burn</h1><p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled.png" alt="Untitled"></p>
<h1 id="0x1-准备工作"><a href="#0x1-准备工作" class="headerlink" title="0x1 准备工作"></a>0x1 准备工作</h1><p>用exeinfo 看到是一个 Delphi写到，添加相应的编译库。<code>View → SubMenu → Signature</code></p>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%201.png" alt="Untitled"></p>
<p>导出为map文件。</p>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%202.png" alt="Untitled"></p>
<blockquote>
<p>同样的map文件，xdbg识别不出来，但是OD却可以;  但是xdbg会给修改的寄存器附一些值、注释，这个OD就没有。</p>
</blockquote>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%203.png" alt="Untitled"></p>
<h1 id="0x2-Serial"><a href="#0x2-Serial" class="headerlink" title="0x2 Serial"></a>0x2 Serial</h1><p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%204.png" alt="Untitled"></p>
<p>搜索字符串</p>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%205.png" alt="Untitled"></p>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%206.png" alt="Untitled"></p>
<h1 id="0x3-Serial-Name"><a href="#0x3-Serial-Name" class="headerlink" title="0x3 Serial/Name"></a>0x3 Serial/Name</h1><p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%207.png" alt="Untitled"></p>
<p>流程分析：</p>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%208.png" alt="Untitled"></p>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%209.png" alt="Untitled"></p>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%2010.png" alt="Untitled"></p>
<p><img src="/2022/05/26/1%20Acid%20Burn%20f9346fdb358c4f61a8da59806a00acac/Untitled%2011.png" alt="Untitled"></p>
<p>总结上述算法逻辑：</p>
<pre><code class="cpp"># 不停的取name的值中的位进行计算：

esi = 第一个字节往左偏移3位 - 第一个字节

0x431754 = esi = 第二个字节往左偏移4位  + esi

esi = 第三个字节 * 0xB

eax = 第二个字节 * 0xE

0x431758 = esi = esi + eax

判断长度是否大于4

0x431750 = 第一个字节 * 0x431750 (这是个硬编码 = 0x29)

0x431750 = 0x431750 + 0x431750
</code></pre>
<h1 id="0x4-注册机"><a href="#0x4-注册机" class="headerlink" title="0x4 注册机"></a>0x4 注册机</h1><p>🈚️，参考：</p>
<pre><code class="cpp">#define _CRT_SECURE_NO_WARNINGS        //去除安全函数的检查
#include&lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;windows.h&gt;
int main()
&#123;
    //密码
    char key1[3] = &quot;CW&quot;;
    char key2[8] = &quot;CRACKED&quot;;
    //输入用户名
    char username[10] = &#123; 0 &#125;;
    printf(&quot;请输入用户名 长度必须大于等于4:&quot;);
    scanf_s(&quot;%s&quot;, username, 10);
    //判断长度
    if (strlen(username) &lt; 4)
    &#123;
        printf(&quot;长度必须大于等于4,请重新输入\n&quot;);
    &#125;
    //根据用户名生成密码
    //计算用户名的第一位
    int username1 = username[0];
    int result1 = (username1 &lt;&lt; 0x3) - username1;  //左移0x3位再减去原来的值
    //计算用户名第二位
    int username2 = username[1];
    result1 = (username1 &lt;&lt; 0x4) + result1;        //左移4位再加上原来的结果
    //计算用户名的第四位
    int username4 = username[3];
    int result2 = username4 * 0xB;                //乘以0xB
    //计算用户名的第三位
    int username3 = username[2];
    result2 = (username3 * 0xE) + result2;        //乘以0xE在加上第四位的结果
    //再次计算第一位
    int result3 = username1 * 0x29 * 2;            //乘以0x29再乘以2
    //将result3转为ASCII 并拼接密钥
    char key[50] = &#123; 0 &#125;;
    sprintf(key, &quot;%s-%d-%s&quot;, key1, result3, key2);
    //打印key
    printf(&quot;密钥为:%s\n&quot;, key);
    system(&quot;pause&quot;);
    return 0;
&#125;
</code></pre>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2022/05/26/2%20Afkayas%20fad7e6f3684147f8abf9e53d6d8c0d4d/">prev</a><a class="next" href="/2022/05/23/Java/JNDI%E6%B3%A8%E5%85%A5/">next</a></div><div class="copyright"><p>&copy; 2023 <a href="http://example.com">Hurn</a>.<br>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/Dreyer/hexo-theme-artemis" target="_blank">Artemis</a>.</p></div></footer></div></body></html>